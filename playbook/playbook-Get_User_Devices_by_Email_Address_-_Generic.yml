contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.8.0
    itemVersion: 2.4.13
    packID: CommonPlaybooks
    packName: Common Playbooks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: |-
  This playbook retrieves information on all of the associated user devices, based on the user email.
  In order to get a generic output, the following information on all of the retrieved devices will be saved under the `UserDevices` context key:
  - Name
  - Serial Number
  - ID
  - Model
  - MAC Address
  - OS
  - Integration

  Note that not all of the supported integrations will be able to retrieve this information.

  Supported integrations:
  - jamf v2
  - Google Workspace (Gsuite)
  - ServiceNow v2
  - Active Directory Query v2
  - Microsoft Graph API (In order to get devices details, provide the permissions as mentioned here: https://learn.microsoft.com/en-us/graph/api/user-list-owneddevices?view=graph-rest-1.0&tabs=http )
id: Get User Devices by Email Address - Generic
inputs:
- description: The email address of the user.
  key: UserEmail
  playbookInputQuery: null
  required: false
  value: {}
- description: If using Google Workspace, a customer ID is needed.
  key: GsuiteCustomerID
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    A custom Active Directory attribute.
    In case there is a custom attribute in Active Directory which stores the name of the computer assigned to the user in the user object, it would be fetched.
  key: CustomADAttribute
  playbookInputQuery: null
  required: false
  value: {}
name: Get User Devices by Email Address - Generic
outputs:
- contextPath: GSuite.MobileDevices
  description: Gsuite mobile devices.
  type: unknown
- contextPath: GSuite.MobileDevices.MobileListObjects
  description: A list of mobile device objects.
- contextPath: GSuite.MobileDevices.MobileListObjects.kind
  description: The type of the API resource.
- contextPath: GSuite.MobileDevices.MobileListObjects.etag
  description: ETag of the resource.
- contextPath: GSuite.MobileDevices.MobileListObjects.resourceId
  description: The unique ID the API service uses to identify the mobile device.
- contextPath: GSuite.MobileDevices.MobileListObjects.deviceId
  description: The serial number for a Google Sync mobile device. For Android and
    iOS devices, this is a software-generated unique identifier.
- contextPath: GSuite.MobileDevices.MobileListObjects.name
  description: A list of the owner's usernames.
- contextPath: GSuite.MobileDevices.MobileListObjects.email
  description: A list of the owner's email addresses.
- contextPath: GSuite.MobileDevices.MobileListObjects.model
  description: The mobile device's model name.
- contextPath: GSuite.MobileDevices.MobileListObjects.os
  description: The mobile device's operating system.
- contextPath: GSuite.MobileDevices.MobileListObjects.type
  description: The type of mobile device.
- contextPath: GSuite.MobileDevices.MobileListObjects.status
  description: The mobile device's status.
- contextPath: GSuite.MobileDevices.MobileListObjects.hardwareId
  description: The IMEI/MEID unique identifier for Android hardware.
- contextPath: GSuite.MobileDevices.MobileListObjects.firstSync
  description: The date and time the mobile device was initially synchronized with
    the policy settings in the Admin console.
- contextPath: GSuite.MobileDevices.MobileListObjects.lastSync
  description: The date and time the mobile device was last synchronized with the
    policy settings in the Admin console.
- contextPath: GSuite.MobileDevices.MobileListObjects.userAgent
  description: Information about the mobile device such as the operating system version.
- contextPath: GSuite.MobileDevices.MobileListObjects.serialNumber
  description: The mobile device's serial number.
- contextPath: GSuite.MobileDevices.MobileListObjects.imei
  description: The mobile device's IMEI number.
- contextPath: GSuite.MobileDevices.MobileListObjects.meid
  description: The mobile device's MEID number.
- contextPath: GSuite.MobileDevices.MobileListObjects.wifiMacAddress
  description: The mobile device's MAC address on Wi-Fi networks.
- contextPath: GSuite.MobileDevices.MobileListObjects.networkOperator
  description: Mobile device mobile or network operator.
- contextPath: GSuite.MobileDevices.MobileListObjects.defaultLanguage
  description: The default locale used on the mobile device.
- contextPath: GSuite.MobileDevices.MobileListObjects.managedAccountIsOnOwnerProfile
  description: Boolean indicating if this account is on the owner/primary profile.
- contextPath: GSuite.MobileDevices.MobileListObjects.deviceCompromisedStatus
  description: The compromised device status.
- contextPath: GSuite.MobileDevices.MobileListObjects.buildNumber
  description: The mobile device's operating system build number.
- contextPath: GSuite.MobileDevices.MobileListObjects.kernelVersion
  description: The mobile device's kernel version.
- contextPath: GSuite.MobileDevices.MobileListObjects.basebandVersion
  description: The mobile device's baseband version.
- contextPath: GSuite.MobileDevices.MobileListObjects.unknownSourcesStatus
  description: Unknown sources enabled or disabled on the mobile device.
- contextPath: GSuite.MobileDevices.MobileListObjects.adbStatus
  description: Whether adb (USB debugging) is enabled on the mobile device.
- contextPath: GSuite.MobileDevices.MobileListObjects.developerOptionsStatus
  description: Whether developer options are enabled on the mobile device.
- contextPath: GSuite.MobileDevices.MobileListObjects.otherAccountsInfo
  description: A list of accounts added on the device.
- contextPath: GSuite.MobileDevices.MobileListObjects.supportsWorkProfile
  description: Work profile supported on the mobile device.
- contextPath: GSuite.MobileDevices.MobileListObjects.manufacturer
  description: Mobile device manufacturer.
- contextPath: GSuite.MobileDevices.MobileListObjects.releaseVersion
  description: Mobile device release version.
- contextPath: GSuite.MobileDevices.MobileListObjects.securityPatchLevel
  description: Mobile device security patch level.
- contextPath: GSuite.MobileDevices.MobileListObjects.brand
  description: Mobile device brand.
- contextPath: GSuite.MobileDevices.MobileListObjects.bootloaderVersion
  description: Mobile device bootloader version.
- contextPath: GSuite.MobileDevices.MobileListObjects.hardware
  description: Mobile device hardware.
- contextPath: GSuite.MobileDevices.MobileListObjects.encryptionStatus
  description: Mobile device encryption status.
- contextPath: GSuite.MobileDevices.MobileListObjects.devicePasswordStatus
  description: Mobile device password status.
- contextPath: GSuite.MobileDevices.MobileListObjects.privilege
  description: DM agent permission.
- contextPath: GSuite.MobileDevices.MobileListObjects.applications
  description: GSuite mobile device applications.
  type: unknown
- contextPath: GSuite.MobileDevices.MobileListObjects.applications.packageName
  description: The application's package name.
- contextPath: GSuite.MobileDevices.MobileListObjects.applications.displayName
  description: The application's display name.
- contextPath: GSuite.MobileDevices.MobileListObjects.applications.versionName
  description: The application's version name.
- contextPath: GSuite.MobileDevices.MobileListObjects.applications.versionCode
  description: The application's version code.
- contextPath: GSuite.MobileDevices.MobileListObjects.applications.permission
  description: The list of permissions of this application.
- contextPath: JAMF.Computer
  description: Jamf computer object.
  type: unknown
- contextPath: JAMF.Computer.id
  description: The computer ID.
- contextPath: JAMF.Computer.name
  description: The computer name.
- contextPath: JAMF.Computer.udid
  description: The computer UDID.
- contextPath: JAMF.Computer.serial_number
  description: The computer serial number.
- contextPath: JAMF.Computer.mac_address
  description: The computer MAC address.
- contextPath: JAMF.Computer.alt_mac_address
  description: The computer alt MAC address.
- contextPath: JAMF.Computer.asset_tag
  description: The computer asset tag.
- contextPath: JAMF.Computer.bar_code_1
  description: The computer barcode 1.
- contextPath: JAMF.Computer.bar_code_2
  description: The computer barcode 2.
- contextPath: JAMF.Computer.username
  description: The computer username.
- contextPath: JAMF.Computer.realname
  description: The computer real name.
- contextPath: JAMF.Computer.email
  description: The computer email address.
- contextPath: JAMF.Computer.email_address
  description: The computer email address.
- contextPath: JAMF.Computer.room
  description: The computer room.
- contextPath: JAMF.Computer.position
  description: The computer position.
- contextPath: JAMF.Computer.building
  description: The computer building.
- contextPath: JAMF.Computer.building_name
  description: The computer building name.
- contextPath: JAMF.Computer.department
  description: The computer department.
- contextPath: JAMF.Computer.department_name
  description: The computer department name.
- contextPath: JAMF.MobileDevice
  description: Jamf mobile device object.
  type: unknown
- contextPath: JAMF.MobileDevice.id
  description: The mobile device ID.
- contextPath: JAMF.MobileDevice.name
  description: The mobile device name.
- contextPath: JAMF.MobileDevice.udid
  description: The mobile device UDID.
- contextPath: JAMF.MobileDevice.serial_number
  description: The mobile device serial number.
- contextPath: JAMF.MobileDevice.mac_address
  description: The mobile device MAC address.
- contextPath: JAMF.MobileDevice.wifi_mac_address
  description: The mobile device WI-FI MAC address.
- contextPath: JAMF.MobileDevice.username
  description: The mobile device username.
- contextPath: JAMF.MobileDevice.realname
  description: The mobile device real name.
- contextPath: JAMF.MobileDevice.email
  description: The mobile device user email address.
- contextPath: JAMF.MobileDevice.email_address
  description: The mobile device user email address.
- contextPath: JAMF.MobileDevice.room
  description: The mobile device room.
- contextPath: JAMF.MobileDevice.position
  description: The mobile device position.
- contextPath: JAMF.MobileDevice.building
  description: The mobile device building.
- contextPath: JAMF.MobileDevice.building_name
  description: The mobile device building name.
- contextPath: JAMF.MobileDevice.department
  description: The mobile device department.
- contextPath: JAMF.MobileDevice.department_name
  description: The mobile device department name.
- contextPath: ServiceNow.Computer
  description: ServiceNow computer object.
  type: unknown
- contextPath: ServiceNow.Computer.ID
  description: Computer system ID.
- contextPath: ServiceNow.Computer.AssetTag
  description: Computer asset tag.
- contextPath: ServiceNow.Computer.Name
  description: Computer name.
- contextPath: ServiceNow.Computer.DisplayName
  description: Computer display name.
- contextPath: ServiceNow.Computer.SupportGroup
  description: Computer support group.
- contextPath: ServiceNow.Computer.OperatingSystem
  description: Computer operating system.
- contextPath: ServiceNow.Computer.Company
  description: Computer company system ID.
- contextPath: ServiceNow.Computer.AssignedTo
  description: Computer assigned to user system ID.
- contextPath: ServiceNow.Computer.State
  description: Computer state.
- contextPath: ServiceNow.Computer.Cost
  description: Computer cost.
- contextPath: ServiceNow.Computer.Comments
  description: Computer comments.
- contextPath: UserDevices
  description: Devices retrieved by this playbook.
  type: unknown
- contextPath: UserDevices.Name
  description: Devices names retrieved by this playbook.
  type: unknown
- contextPath: UserDevices.SerialNumber
  description: Devices serial numbers retrieved by this playbook.
  type: unknown
- contextPath: UserDevices.ID
  description: Devices IDs retrieved by this playbook.
  type: unknown
- contextPath: UserDevices.Model
  description: Devices models retrieved by this playbook.
  type: unknown
- contextPath: UserDevices.OS
  description: Devices operating systems retrieved by this playbook.
  type: unknown
- contextPath: UserDevices.Integration
  description: The integration which retrieved the devices.
  type: unknown
- contextPath: UserDevices.MACAddress
  description: Devices MAC Address retrieved by this playbook.
  type: unknown
- contextPath: MicrosoftGraph
  description: MicrosoftGraph results.
  type: unknown
- contextPath: MicrosoftGraph.profileType
  description: Device profile type.
  type: unknown
- contextPath: MicrosoftGraph.operatingSystemVersion
  description: Device OS version.
  type: unknown
- contextPath: MicrosoftGraph.displayName
  description: Device display name.
  type: unknown
- contextPath: MicrosoftGraph.operatingSystem
  description: Device OS.
  type: unknown
- contextPath: MicrosoftGraph.deviceId
  description: Device ID.
  type: unknown
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: af53b702-bed1-4168-8bf7-b595e9a88ebf
      iscommand: false
      name: ""
      version: -1
    taskid: af53b702-bed1-4168-8bf7-b595e9a88ebf
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -540,
          "y": -60
        }
      }
  "1":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.UserEmail
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "14"
      "yes":
      - "2"
      - "8"
      - "15"
      - "24"
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b39dc8a4-1b7b-4cb9-8f38-2eead03f9fa1
      iscommand: false
      name: UserEmail exists?
      type: condition
      version: -1
    taskid: b39dc8a4-1b7b-4cb9-8f38-2eead03f9fa1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -540,
          "y": 120
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 544397f7-475e-4a00-84dd-3ab24d8e4ca3
      iscommand: false
      name: Google Workspace (Gsuite)
      type: title
      version: -1
    taskid: 544397f7-475e-4a00-84dd-3ab24d8e4ca3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 40,
          "y": 340
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      customer_id:
        complex:
          root: inputs.GsuiteCustomerID
      query:
        simple: email:${inputs.UserEmail}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Retrieves a paginated list that includes company-owned mobile devices.
      id: 2d755788-43a2-4676-8ae3-143261e765f6
      iscommand: true
      name: Google Workspace - Get device details
      script: '|||gsuite-mobiledevice-list'
      type: regular
      version: -1
    taskid: 2d755788-43a2-4676-8ae3-143261e765f6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 890
        }
      }
  "5":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.GsuiteCustomerID
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a50ab795-1aa7-4e4f-8aa2-f4742985f47e
      iscommand: false
      name: Customer ID exist?
      type: condition
      version: -1
    taskid: a50ab795-1aa7-4e4f-8aa2-f4742985f47e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 500
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "13"
      "yes":
      - "4"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: GSuiteAdmin
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 37e9ddaf-5126-4655-8379-bea5b950e24a
      iscommand: false
      name: GSuiteAdmin enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 37e9ddaf-5126-4655-8379-bea5b950e24a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 710
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6f4cf496-6f9c-4136-8cde-165da884b795
      iscommand: false
      name: Done - Jamf
      type: title
      version: -1
    taskid: 6f4cf496-6f9c-4136-8cde-165da884b795
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 630,
          "y": 1610
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4542cda1-c64f-400b-8fca-a1800a9b3bdb
      iscommand: false
      name: Jamf
      type: title
      version: -1
    taskid: 4542cda1-c64f-400b-8fca-a1800a9b3bdb
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 630,
          "y": 340
        }
      }
  "9":
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      match:
        complex:
          root: inputs.UserEmail
    separatecontext: false
    skipunavailable: true
    task:
      brand: jamf v2
      description: Matches computers by specific characteristics and returns general
        data on each of the computers.
      id: 1ebadc42-526d-4d3d-8c4a-f436142037d3
      iscommand: true
      name: Jamf Pro - Get computer details
      script: jamf v2|||jamf-get-computer-by-match
      type: regular
      version: -1
    taskid: 1ebadc42-526d-4d3d-8c4a-f436142037d3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": 670
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "7"
      "yes":
      - "9"
      - "11"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: jamf v2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 4ce06688-5049-4290-871b-1407d8dd7444
      iscommand: false
      name: jamf v2 enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 4ce06688-5049-4290-871b-1407d8dd7444
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 630,
          "y": 500
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    scriptarguments:
      match:
        complex:
          root: inputs.UserEmail
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Matches mobile devices by specific characteristics and returns
        general data on each one of the mobile devices.
      id: 503fdfc8-c837-4070-8e40-57fa280c0d0a
      iscommand: true
      name: Jamf Pro - Get mobile device details
      script: '|||jamf-get-mobile-device-by-match'
      type: regular
      version: -1
    taskid: 503fdfc8-c837-4070-8e40-57fa280c0d0a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 670
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ccdd5243-0807-4790-82a8-4cdd640c292a
      iscommand: false
      name: Done - GSuite
      type: title
      version: -1
    taskid: ccdd5243-0807-4790-82a8-4cdd640c292a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1610
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea16bf47-d31a-45d5-83a7-704f585cf793
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: ea16bf47-d31a-45d5-83a7-704f585cf793
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2220,
          "y": 340
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0e57178d-04ec-4385-8a3a-1f862a63e55d
      iscommand: false
      name: ServiceNow CMDB
      type: title
      version: -1
    taskid: 0e57178d-04ec-4385-8a3a-1f862a63e55d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -540,
          "y": 340
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "20"
      "yes":
      - "17"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: ServiceNow v2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: cc138021-9029-463e-8771-2d84742a4ef9
      iscommand: false
      name: ServiceNow v2 enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: cc138021-9029-463e-8771-2d84742a4ef9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -540,
          "y": 500
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    scriptarguments:
      query:
        simple: email=${inputs.UserEmail}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ServiceNow v2
      description: Queries the sys_user table in ServiceNow.
      id: 3682177f-81cc-43db-8688-9e811de26291
      iscommand: true
      name: Get user ID by email
      script: ServiceNow v2|||servicenow-query-users
      type: regular
      version: -1
    taskid: 3682177f-81cc-43db-8688-9e811de26291
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": 700
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                root: ServiceNow.User
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "20"
      "yes":
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 02252af0-eba9-4d5c-898e-a53827672bed
      iscommand: false
      name: User found?
      type: condition
      version: -1
    taskid: 02252af0-eba9-4d5c-898e-a53827672bed
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -540,
          "y": 870
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      query:
        simple: assigned_to=${ServiceNow.User.ID}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ServiceNow v2
      description: Queries the cmdb_ci_computer table in ServiceNow.
      id: 5fff1e7b-4ea4-4af8-8be0-ab0618869037
      iscommand: true
      name: Get computer details by UserID
      script: ServiceNow v2|||servicenow-query-computers
      type: regular
      version: -1
    taskid: 5fff1e7b-4ea4-4af8-8be0-ab0618869037
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": 1050
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2a2fcf71-a92c-4875-8dd7-f458b06dec5a
      iscommand: false
      name: Done - SNOW
      type: title
      version: -1
    taskid: 2a2fcf71-a92c-4875-8dd7-f458b06dec5a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -540,
          "y": 1610
        }
      }
  "21":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: SnowComputers
          operator: isNotEmpty
          right:
            value: {}
        - left:
            iscontext: true
            value:
              complex:
                root: GoogleDevices
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                root: JamfMobileDevices
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                root: JamfComputers
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                root: ADComputer
          operator: isNotEmpty
        - left:
            iscontext: true
            value:
              complex:
                root: MSGraphDevices
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "23"
      "yes":
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c0ac4f79-8171-469c-88c0-9929e7828c57
      iscommand: false
      name: Check if any device found
      type: condition
      version: -1
    taskid: c0ac4f79-8171-469c-88c0-9929e7828c57
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -540,
          "y": 1830
        }
      }
  "22":
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: UserDevices
      value:
        complex:
          root: SnowComputers
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: GoogleDevices
              raw: {}
            operator: AppendIfNotEmpty
          - args:
              item:
                iscontext: true
                value:
                  simple: JamfMobileDevices
              raw: {}
            operator: AppendIfNotEmpty
          - args:
              item:
                iscontext: true
                value:
                  simple: JamfComputers
              raw: {}
            operator: AppendIfNotEmpty
          - args:
              item:
                iscontext: true
                value:
                  simple: ADComputer
              raw: {}
            operator: AppendIfNotEmpty
          - args:
              item:
                iscontext: true
                value:
                  simple: MSGraphDevices
              raw: {}
            operator: AppendIfNotEmpty
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.11/Cortex-XSOAR-Administrator-Guide/Automations
      id: 9293016c-3340-4bb2-870d-48ab12bea3fd
      iscommand: false
      name: Set UserDevices
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 9293016c-3340-4bb2-870d-48ab12bea3fd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": 2040
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4bfbaf8f-85a4-44bb-8765-9c175a74df93
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 4bfbaf8f-85a4-44bb-8765-9c175a74df93
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -540,
          "y": 2210
        }
      }
  "24":
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aa3e9512-8566-4722-8f8b-2a611c60c2fd
      iscommand: false
      name: Active Directory
      type: title
      version: -1
    taskid: aa3e9512-8566-4722-8f8b-2a611c60c2fd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 340
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.CustomADAttribute
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "26"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c6eec195-b3ef-46ff-840d-e13e407bdc4c
      iscommand: false
      name: CustomADAttribute exist?
      type: condition
      version: -1
    taskid: c6eec195-b3ef-46ff-840d-e13e407bdc4c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 500
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "28"
      "yes":
      - "27"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Active Directory Query v2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 39851b37-ed87-40cf-8826-e09f468f47fd
      iscommand: false
      name: Active Directory Query v2 enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 39851b37-ed87-40cf-8826-e09f468f47fd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 700
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      attributes:
        complex:
          root: inputs.CustomADAttribute
      email:
        complex:
          root: inputs.UserEmail
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Retrieves detailed information about a user account. The user can
        be specified by name, email address, or as an Active Directory Distinguished
        Name (DN). If no filter is specified, all users are returned.
      id: 29684d8f-17d1-4eb4-8829-78927db140df
      iscommand: true
      name: Get user details
      script: '|||ad-get-user'
      type: regular
      version: -1
    taskid: 29684d8f-17d1-4eb4-8829-78927db140df
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 890
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f68283f-29ac-49c8-8058-c9bdce1cace8
      iscommand: false
      name: Done - AD
      type: title
      version: -1
    taskid: 4f68283f-29ac-49c8-8058-c9bdce1cace8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 1610
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: ADComputerName
      value:
        complex:
          accessor: Users
          root: ActiveDirectory
          transformers:
          - args:
              field:
                iscontext: true
                value:
                  simple: inputs.CustomADAttribute
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.11/Cortex-XSOAR-Administrator-Guide/Automations
      id: 184f208a-aad3-424c-842f-f295ae708111
      iscommand: false
      name: Save the custom attribute value
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 184f208a-aad3-424c-842f-f295ae708111
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 1250
        }
      }
  "30":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: id
                root: JAMF.Computer
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8e29f1d1-c9e0-4d5e-87c7-9cb9d5c31aa8
      iscommand: false
      name: Any results?
      type: condition
      version: -1
    taskid: 8e29f1d1-c9e0-4d5e-87c7-9cb9d5c31aa8
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 850
        }
      }
  "31":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: id
                root: JAMF.MobileDevice
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "7"
      "yes":
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 718119f3-882d-4126-878f-89e3ce9ca174
      iscommand: false
      name: Any results?
      type: condition
      version: -1
    taskid: 718119f3-882d-4126-878f-89e3ce9ca174
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 850
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        complex:
          accessor: id
          root: JAMF.Computer
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: 'Returns the "general" subset of a specific computer, e.g.: name,
        MAC address, IP, serial number, UDID, etc.'
      id: 3853d860-e3a9-45c7-8462-42c88f1a0587
      iscommand: true
      name: Get computer information
      script: '|||jamf-get-computer-by-id'
      type: regular
      version: -1
    taskid: 3853d860-e3a9-45c7-8462-42c88f1a0587
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1065
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "35"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        complex:
          accessor: id
          root: JAMF.MobileDevice
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: 'Returns the "general" subset of a specific mobile device, e.g.:
        name, MAC address, IP, serial number, UDID. etc.'
      id: 910a38ab-dbb4-42b1-8efb-e047703d1c5e
      iscommand: true
      name: Get mobile device information
      script: '|||jamf-get-mobile-device-by-id'
      type: regular
      version: -1
    taskid: 910a38ab-dbb4-42b1-8efb-e047703d1c5e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 1065
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: JamfComputers
      value:
        simple: '${JAMF.Computer={Name: val[''name''], SerialNumber: val[''serial_number''],
          ID: val[''id''], Model: val[''platform''], MACAddress: val[''mac_address''],
          OS: '''', Integration: ''jamf v2''}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.11/Cortex-XSOAR-Administrator-Guide/Automations
      id: b9eed896-0f9f-47b1-843b-5ce5749e3288
      iscommand: false
      name: set JamfComputers
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: b9eed896-0f9f-47b1-843b-5ce5749e3288
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1240
        }
      }
  "35":
    continueonerrortype: ""
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: JamfMobileDevices
      value:
        simple: '${JAMF.MobileDevice={Name: val[''name''], SerialNumber: val[''serial_number''],
          ID: val[''id''], Model: val[''model''], MACAddress: val[''wifi_mac_address''],
          OS: '''', Integration: ''jamf v2''}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.11/Cortex-XSOAR-Administrator-Guide/Automations
      id: 20a86189-8aaf-47b3-81ca-36fc70ad4181
      iscommand: false
      name: set JamfMobileDevices
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 20a86189-8aaf-47b3-81ca-36fc70ad4181
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1380,
          "y": 1240
        }
      }
  "36":
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: JamfComputers
      value:
        complex:
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: JamfComputers.ID
              operator: isExists
          root: JamfComputers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.11/Cortex-XSOAR-Administrator-Guide/Automations
      id: 6ad641e8-da8e-4101-817b-dc24f655ab2f
      iscommand: false
      name: Remove null results
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 6ad641e8-da8e-4101-817b-dc24f655ab2f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 900,
          "y": 1410
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: deviceId
                root: GSuite.MobileDevices.MobileListObjects
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "13"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b443b306-b64f-459b-8759-47c930ea73f7
      iscommand: false
      name: Any results?
      type: condition
      version: -1
    taskid: b443b306-b64f-459b-8759-47c930ea73f7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1050
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: GoogleDevices
      value:
        simple: '${GSuite.MobileDevices.MobileListObjects={Name: val[''name''], SerialNumber:
          val[''serialNumber''], ID: val[''deviceId''], Model: val[''model''], MACAddress:
          val[''wifiMacAddress''], OS: val[''os''], Integration: ''GSuiteAdmin''}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.11/Cortex-XSOAR-Administrator-Guide/Automations
      id: e0010aad-6fdd-49dd-8a08-c446a014c14f
      iscommand: false
      name: Set GoogleDevices
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: e0010aad-6fdd-49dd-8a08-c446a014c14f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1250
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ID
                root: ServiceNow.Computer
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "20"
      "yes":
      - "40"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 383b2b83-ee82-4013-8d3c-42d004722163
      iscommand: false
      name: Any results?
      type: condition
      version: -1
    taskid: 383b2b83-ee82-4013-8d3c-42d004722163
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -540,
          "y": 1230
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: SnowComputers
      value:
        simple: '${ServiceNow.Computer={Name: val[''Name''], SerialNumber: '''', ID:
          val[''ID''], Model: '''', MACAddress: '''', OS: val[''OperatingSystem''],
          Integration: ''ServiceNow v2''}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.11/Cortex-XSOAR-Administrator-Guide/Automations
      id: e30ea76a-0a74-4596-84c6-328438aa6024
      iscommand: false
      name: Set SnowComputers
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: e30ea76a-0a74-4596-84c6-328438aa6024
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -540,
          "y": 1420
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      keys:
        simple: Name,SerialNumber,ID,Model,MACAddress,OS,Integration
      parent:
        simple: ADComputer
      values:
        simple: ${ADComputerName},,,,,,Active Directory Query v2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set multiple keys/values to the context.
      id: 96a68565-f28f-4a7d-882f-28c6aa15ab0a
      iscommand: false
      name: Set ADComputer
      script: SetMultipleValues
      type: regular
      version: -1
    taskid: 96a68565-f28f-4a7d-882f-28c6aa15ab0a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 1430
        }
      }
  "42":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Users
                root: ActiveDirectory
                transformers:
                - args:
                    field:
                      iscontext: true
                      value:
                        simple: inputs.CustomADAttribute
                  operator: getField
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "28"
      "yes":
      - "29"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e1a0002-70c4-448b-8c36-faa96e372365
      iscommand: false
      name: Any results?
      type: condition
      version: -1
    taskid: 1e1a0002-70c4-448b-8c36-faa96e372365
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1120,
          "y": 1050
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6f42217d-7791-434e-80ce-1b65b0483b85
      iscommand: false
      name: Microsoft Graph API
      type: title
      version: -1
    taskid: 6f42217d-7791-434e-80ce-1b65b0483b85
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1680,
          "y": 340
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "no":
      - "46"
      "yes":
      - "45"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Microsoft Graph API
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: b3ca6346-d3f9-41e6-8085-ed27033345a9
      iscommand: false
      name: Microsoft Graph API enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: b3ca6346-d3f9-41e6-8085-ed27033345a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1680,
          "y": 500
        }
      }
  "45":
    continueonerror: true
    continueonerrortype: errorPath
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#error#':
      - "46"
      '#none#':
      - "47"
    note: false
    quietmode: 0
    scriptarguments:
      resource:
        simple: /users/${inputs.UserEmail}/ownedDevices
    separatecontext: false
    skipunavailable: true
    task:
      brand: Microsoft Graph API
      description: Run a Microsoft Graph API query.
      id: f0d84075-0543-4c7b-8ee4-b5451507b771
      iscommand: true
      name: MSGraphAPI - Get user owned devices
      script: Microsoft Graph API|||msgraph-api-request
      type: regular
      version: -1
    taskid: f0d84075-0543-4c7b-8ee4-b5451507b771
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1680,
          "y": 690
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0d576358-3344-45c0-85ed-735ace5ffb99
      iscommand: false
      name: MSGraph API - Done
      type: title
      version: -1
    taskid: 0d576358-3344-45c0-85ed-735ace5ffb99
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1680,
          "y": 1610
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: deviceId
                root: MicrosoftGraph
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 60e068dd-b484-40eb-8432-8f729d3e6391
      iscommand: false
      name: Any results?
      type: condition
      version: -1
    taskid: 60e068dd-b484-40eb-8432-8f729d3e6391
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1680,
          "y": 880
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "46"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: MSGraphDevices
      value:
        simple: '${MicrosoftGraph={Name: val[''displayName''], SerialNumber: '''',
          ID: val[''deviceId''], Model: '''', MACAddress: '''', OS: val[''operatingSystem''],
          Integration: ''Microsoft Graph API''}}'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.11/Cortex-XSOAR-Administrator-Guide/Automations
      id: 9c9a33be-a077-4903-8a1e-0bc8a6c7983c
      iscommand: false
      name: Set MSGraphDevices
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 9c9a33be-a077-4903-8a1e-0bc8a6c7983c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1680,
          "y": 1080
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "10_7_no": 0.29,
      "16_17_yes": 0.36,
      "16_20_no": 0.13,
      "18_19_yes": 0.46,
      "18_20_#default#": 0.1,
      "1_15_yes": 0.46,
      "25_26_yes": 0.38,
      "25_28_#default#": 0.1,
      "26_28_no": 0.12,
      "30_32_yes": 0.39,
      "30_7_#default#": 0.18,
      "31_33_yes": 0.51,
      "31_7_#default#": 0.2,
      "37_13_#default#": 0.13,
      "39_20_#default#": 0.33,
      "42_28_#default#": 0.11,
      "42_29_yes": 0.43,
      "44_46_no": 0.15,
      "45_46_#error#": 0.18,
      "47_46_#default#": 0.12,
      "5_13_#default#": 0.1,
      "5_6_yes": 0.52,
      "6_13_no": 0.15,
      "6_4_yes": 0.49
    },
    "paper": {
      "dimensions": {
        "height": 2335,
        "width": 3980,
        "x": -2220,
        "y": -60
      }
    }
  }
