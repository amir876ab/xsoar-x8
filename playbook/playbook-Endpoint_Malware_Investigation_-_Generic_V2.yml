contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 1.4.9
    packID: Malware
    packName: Malware Core
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
deprecated: true
description: "Deprecated. Use 'Malware Investigation & Response Incident handler'
  instead. (From the 'Malware Investigation And Response Pack')\n\n\n This playbook
  provides a framework for handling malware investigation through all essential steps.
  The playbook consists of 7 stages. Each stage contains the relevant playbook or
  tasks. \nThis playbook auto extracts indicators from incidents using indicator extraction
  rules of the malware incident type.\nTo use Illusive integration in the `Forensics
  - Generic` playbook,  note that you will be able to set the forensic timeline by
  editing the `Forensics - Generic` playbook inputs.  \n    "
id: Endpoint Malware Investigation - Generic V2
inputs:
- description: |-
    This input determines the threshold severity from which to perform auto-isolation for the infected endpoint.
    Specify the severity number (Default is 3 - High):
    Specify the severity number:
    0 - Unknown
    0.5 - Informational
    1 - Low
    2 - Medium
    3 - High
    4 - Critical
  key: AutoIsolation
  playbookInputQuery: null
  required: false
  value:
    simple: "3"
- description: The email address to send a notification if there is a possibility
    of the malware spreading and infecting other endpoints.
  key: Email
  playbookInputQuery: null
  required: false
  value: {}
- description: The MD5 hash value for the suspicious file.
  key: MD5
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: md5
      root: incident
- description: The SHA256 hash value for the suspicious file.
  key: SHA256
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: sha256
      root: incident
- description: Hostname of the machine on which the file is located.
  key: Hostname
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: hostname
      root: incident
- description: |-
    The path of the file to retrieve.
    For example:
    C:\users\folder\file.txt
  key: FilePath
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: Path
      root: File
- description: Specifies whether to use a D2 agent to retrieve the file.
  key: UseD2
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: The SHA1 hash value for the suspicious file.
  key: SHA1
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: sha1
      root: incident
- description: |
    Activate Threat Hunting - Generic playbook for automatic hunting.
    Yes- to activate.
  key: ActivateAutomaticHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: |
    Perform manual threat hunting.
    Yes- to activate.
  key: ManualThreatHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "No"
- description: "The value `Yes` will activate the playbook `Forensics - Generic` that
    retrieves additional forensics on the investigating host. \nYes- to activate,"
  key: NeedMoreForensics
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nIf you activated the Threat Hunting - Generic playbook and you are
    hunting IP addresses, provide the IP addresses here.\n"
  key: IPAddress
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nIf you activated Threat Hunting - Generic playbook and you are hunting
    for URLs or domains, provide the URLs or domains here."
  key: URLDomain
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nThe input is a list of internal IP ranges to check IP addresses against.
    The list should be provided in CIDR notation, separated by commas. An example
    of a list of ranges would be: \"172.16.0.0/12,10.0.0.0/8,192.168.0.0/16\" (without
    quotes). If a list is not provided, the playbook will use the default list provided
    in the IsIPInRanges script (the known IPv4 private address ranges)."
  key: InternalRange
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input is relevant if the Threat Hunting - Generic playbook is
    activated. \nThe input is the organization's internal domain name. This is provided
    for the IsInternalHostName script that checks if the detected host names are internal
    or external if the hosts contain the internal domains suffix. For example, demisto.com.
    If there is more than one domain, use the | character to separate values such
    as (demisto.com|test.com)"
  key: InternalDomainName
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input is relevant if the Threat Hunting - Generic playbook is activated.
    This is provided for the IsInternalHostName script that checks if the detected host names are internal or external if the hosts match the organizations naming convention. For example, the host testpc1 will have the following regex \w{6}\d{1}
  key: InternalHostRegex
  playbookInputQuery: null
  required: false
  value: {}
- description: This input is relevant if retrieving the file by EDR. If so, provide
    the relevant Agent_ID\Endpoint id.
  key: Agent_ID
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: agentsid
      root: incident
- description: |-
    This input will be used for the `Calculate Severity - Generic v2` playbook.
    Provide your critical users (CSV is optional).
  key: CriticalUsers
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input will be uses for the `Calculate Severity - Generic v2` playbook.
    Provide your critical endpoint hostnames (CSV is optional).
  key: CriticalEndpoints
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input will be uses for the `Calculate Severity - Generic v2` playbook.
    Provide the DN names of your critical AD groups (CSV is optional).
  key: CriticalGroups
  playbookInputQuery: null
  required: false
  value: {}
- description: Providing "Yes" in this playbook input will activated the "Unisolate
    Endpoint - Generic" playbook.
  key: AutoUnIsolation
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: The IP of the endpoint which is involved in the investigation.
  key: Endpoint_ip
  playbookInputQuery: null
  required: false
  value: {}
- description: Providing "Yes" in this playbook input will link the incidents that
    were found similar by DBotFindSimilarIncidents.
  key: LinkSimilarIncidents
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: Providing "Yes" to this input will activate the "Detonate File - Generic".
  key: DetonateFile
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
- description: Providing "Yes" to this input will activate the "Isolate Endpoint Generic
    V2" after the execution of threat hunting procedures.
  key: IsolationAfterHunting
  playbookInputQuery: null
  required: false
  value:
    simple: "no"
name: Endpoint Malware Investigation - Generic V2
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0cabbf80-a3dd-4059-8b1c-4565468c87f2
      iscommand: false
      name: ""
      version: -1
    taskid: 0cabbf80-a3dd-4059-8b1c-4565468c87f2
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 490,
          "y": 50
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6271a410-2cd4-443a-88d9-615eff451d1b
      iscommand: false
      name: Detonation
      type: title
      version: -1
    taskid: 6271a410-2cd4-443a-88d9-615eff451d1b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2030
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fd535da5-5719-4043-8620-cbb70478c5d5
      iscommand: false
      name: File enrichment
      type: title
      version: -1
    taskid: fd535da5-5719-4043-8620-cbb70478c5d5
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2030
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 17d128e8-8bd1-473d-8507-661d65baa512
      iscommand: false
      name: Hunting
      type: title
      version: -1
    taskid: 17d128e8-8bd1-473d-8507-661d65baa512
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 180,
          "y": 5570
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: fd48ea68-ad9b-4f67-8176-859f92b43f99
      iscommand: false
      name: Remediation
      type: title
      version: -1
    taskid: fd48ea68-ad9b-4f67-8176-859f92b43f99
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8435
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "41"
      "Yes":
      - "115"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 97d16faf-f205-43bd-81cc-51723d090891
      iscommand: false
      name: Manual - Get analyst approval for auto-remediation
      type: condition
      version: -1
    taskid: 97d16faf-f205-43bd-81cc-51723d090891
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8560
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9e386b2c-d669-4d53-8259-8f75a40cab83
      iscommand: false
      name: Analyst review of the investigation
      type: regular
      version: -1
    taskid: 9e386b2c-d669-4d53-8259-8f75a40cab83
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 8900
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Unisolate endpoints that were isolated during the investigation
        after remediation.
      id: 141f0ef8-0aa7-426b-8f64-2a90f54268e7
      iscommand: false
      name: Manual - Unisolate endpoints
      type: regular
      version: -1
    taskid: 141f0ef8-0aa7-426b-8f64-2a90f54268e7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 20,
          "y": 9600
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Enrich a file with threat information using one or more integrations.
      id: 586b48ab-bc00-4db2-8839-aefb9ad7d5f0
      iscommand: false
      name: File Enrichment - Generic v2
      playbookId: File Enrichment - Generic v2
      type: playbook
      version: -1
    taskid: 586b48ab-bc00-4db2-8839-aefb9ad7d5f0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 90,
          "y": 2160
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    scriptarguments:
      EntryID:
        complex:
          accessor: EntryID
          root: File
      File:
        complex:
          root: File
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Detonate file through active integrations that support file detonation.
      id: e5d4d79d-9779-4111-8166-e0247d0111eb
      iscommand: false
      name: Detonate File - Generic
      playbookId: Detonate File - Generic
      type: playbook
      version: -1
    taskid: e5d4d79d-9779-4111-8166-e0247d0111eb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2950
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate an automated investigation summary report.
        Can be used in the post-processing flow as well.
      id: 944c67f9-dfaf-4687-8aec-8c1311b548ec
      iscommand: false
      name: Generate Investigation Summary Report
      script: GenerateInvestigationSummaryReport
      tags:
      - Investigation-Report
      type: regular
      version: -1
    taskid: 944c67f9-dfaf-4687-8aec-8c1311b548ec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9065
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: EntryID
                root: File
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "37"
      "yes":
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 71660000-00bd-413e-8b2a-0359d4cfa60f
      iscommand: false
      name: Was a file retrieved?
      type: condition
      version: -1
    taskid: 71660000-00bd-413e-8b2a-0359d4cfa60f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2330
        }
      }
  "37":
    continueonerrortype: ""
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "123"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d3db3bec-4974-42d0-8929-210476cec410
      iscommand: false
      name: Retrieve file manually
      type: regular
      version: -1
    taskid: d3db3bec-4974-42d0-8929-210476cec410
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 2510
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually hunt for other infected endpoints.
      id: 04f9ba5b-95d5-489a-8431-0d42afc14a24
      iscommand: false
      name: Manual - Hunt for other infected endpoints
      type: regular
      version: -1
    taskid: 04f9ba5b-95d5-489a-8431-0d42afc14a24
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6705
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "103"
      "Yes":
      - "77"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 90295741-ec68-4f5b-8668-bdf67bd19ac7
      iscommand: false
      name: Were there any more infected endpoints found?
      type: condition
      version: -1
    taskid: 90295741-ec68-4f5b-8668-bdf67bd19ac7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 50,
          "y": 6855
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: d1a94ca9-aa8b-41c4-8cdf-33744a6d50e4
      iscommand: false
      name: Analyst manual remediation
      type: regular
      version: -1
    taskid: d1a94ca9-aa8b-41c4-8cdf-33744a6d50e4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 8730
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 21cade3e-8dcb-4621-8dd7-9678c92c11bc
      iscommand: false
      name: Perform manual malware analysis and forensics
      type: regular
      version: -1
    taskid: 21cade3e-8dcb-4621-8dd7-9678c92c11bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 190,
          "y": 5080
        }
      }
  "45":
    continueonerrortype: ""
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "74"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 738eb542-3cca-4af8-8cc6-95be8949ead3
      iscommand: false
      name: False Positive
      type: title
      version: -1
    taskid: 738eb542-3cca-4af8-8cc6-95be8949ead3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -670,
          "y": 4350
        }
      }
  "46":
    continueonerrortype: ""
    id: "46"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      "No":
      - "98"
      "Yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2196bb67-db15-4212-87b6-a4b70827fbe5
      iscommand: false
      name: Get analyst approval for local containment
      type: condition
      version: -1
    taskid: 2196bb67-db15-4212-87b6-a4b70827fbe5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 190,
          "y": 4405
        }
      }
  "50":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: inputs.AutoIsolation
                    operator: lessThanOrEqual
                    right:
                      iscontext: true
                      value:
                        simple: incident.severity
                root: inputs.AutoIsolation
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "46"
      "yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f3a332f2-73d4-412d-848e-e9471bc59735
      iscommand: false
      name: Auto-Isolation?
      type: condition
      version: -1
    taskid: f3a332f2-73d4-412d-848e-e9471bc59735
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4210
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      Continue Investigation:
      - "50"
      False positive:
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 42186c9c-965f-495b-8ca6-9d7344b72c4f
      iscommand: false
      name: Continue with the investigation or close as false positive?
      type: condition
      version: -1
    taskid: 42186c9c-965f-495b-8ca6-9d7344b72c4f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3920
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    scriptarguments:
      Account:
        complex:
          root: Account
          transformers:
          - operator: uniq
      CriticalEndpoints:
        complex:
          root: inputs.CriticalEndpoints
          transformers:
          - operator: uniq
      CriticalGroups:
        complex:
          root: inputs.CriticalGroups
          transformers:
          - operator: uniq
      CriticalUsers:
        complex:
          root: inputs.CriticalUsers
          transformers:
          - operator: uniq
      DBotScore:
        complex:
          root: DBotScore
      EmailAuthenticityCheck:
        complex:
          accessor: AuthenticityCheck
          root: Email
          transformers:
          - operator: uniq
      Endpoint:
        complex:
          accessor: Hostname
          root: incident
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Calculate and assign the incident severity based on the highest returned severity level from the following calculations:

        - DBotScores of indicators
        - Critical assets
        - Email authenticity
        - Current incident severity
      id: 86555c00-cfe0-4c6c-8555-38cd84aa3f5d
      iscommand: false
      name: Calculate Severity - Generic v2
      playbookId: Calculate Severity - Generic v2
      type: playbook
      version: -1
    taskid: 86555c00-cfe0-4c6c-8555-38cd84aa3f5d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3400
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: |-
          During an endpoint malware investigation in Cortex XSOAR, other infected endpoints were found, which can possibly indicate the malware is spreading in your organization and requires your attention.
          To get more information, go to this incident in Cortex XSOAR: ${incident.id}
      subject:
        simple: Potential malware spreading in your organization
      to:
        complex:
          root: inputs.Email
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email
      id: fe6e5b6b-ab55-42a9-8d41-b75dd42b83b7
      iscommand: true
      name: Notify that more infected endpoints were found
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: fe6e5b6b-ab55-42a9-8d41-b75dd42b83b7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 830,
          "y": 7540
        }
      }
  "56":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Email
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "66"
      "yes":
      - "55"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c950586c-1fd2-489a-8efb-da296eeaf41b
      iscommand: false
      name: Send notification regarding infected endpoints?
      type: condition
      version: -1
    taskid: c950586c-1fd2-489a-8efb-da296eeaf41b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7370
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2ea6e5e0-79a1-4a39-8657-ebe90810e683
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 2ea6e5e0-79a1-4a39-8657-ebe90810e683
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -670,
          "y": 10350
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: ${Closing reason.Answers.0}
      id:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: dac65125-cb69-4660-805d-3f8bab2f3f12
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: dac65125-cb69-4660-805d-3f8bab2f3f12
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 10140
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Close the incident in the source product that triggered it.
      id: a1ee1c8b-fe56-4b50-84d2-16b666b80b87
      iscommand: false
      name: Manual - Close incident in the source product
      type: regular
      version: -1
    taskid: a1ee1c8b-fe56-4b50-84d2-16b666b80b87
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -220,
          "y": 9810
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "98"
    note: false
    quietmode: 0
    scriptarguments:
      isolated:
        simple: Endpoint was isolated successfully.
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Change the properties of an incident
      id: 8129149c-e30c-4bc7-8d52-1a56eb179e47
      iscommand: true
      name: Set incident - Isolated field
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8129149c-e30c-4bc7-8d52-1a56eb179e47
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4760
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "124"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4b89d219-eafb-40ae-84c4-35972bfcea56
      iscommand: false
      name: Isolate infected endpoints
      type: title
      version: -1
    taskid: 4b89d219-eafb-40ae-84c4-35972bfcea56
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7710
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    scriptarguments:
      Agent_ID:
        simple: ${Endpoint.ID}
      Hostname:
        simple: ${Endpoint.Hostname}
      MD5:
        simple: ${inputs.MD5}
      Path:
        simple: ${inputs.FilePath}
      SHA256:
        simple: ${inputs.SHA256}
      UseD2:
        simple: ${inputs.UseD2}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        'This playbook retrieves a file sample from an endpoint using the following playbooks:'
        - Get File Sample From Path - Generic v2.
        - Get File Sample By Hash - Generic v3.
      id: 66fb5401-fe10-42e4-8f46-306dda97e67c
      iscommand: false
      name: Retrieve File from Endpoint - Generic V2
      playbookId: Retrieve File from Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 66fb5401-fe10-42e4-8f46-306dda97e67c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2160
        }
      }
  "68":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ActivateAutomaticHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 95d9be7c-abcf-40d1-8e37-5460732670af
      iscommand: false
      name: Activate automatic hunting
      type: condition
      version: -1
    taskid: 95d9be7c-abcf-40d1-8e37-5460732670af
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 180,
          "y": 5720
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "101"
    note: false
    quietmode: 0
    scriptarguments:
      Hostname:
        simple: ${Endpoint.Hostname}
      InternalDomainName:
        simple: ${inputs.InternalDomainName}
      InternalHostRegex:
        simple: ${inputs.InternalHostRegex}
      InternalRange:
        simple: ${inputs.InternalRange}
      MD5:
        simple: ${inputs.MD5}
      SHA1:
        simple: ${inputs.SHA1}
      SHA256:
        simple: ${inputs.SHA256}
      URLDomain:
        simple: ${inputs.URLDomain}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook enables threat hunting for IOCs in your enterprise.\nThis
        playbook currently supports the following integrations:\n- Splunk\n- Qradar\n-
        Pan-os\n- Cortex data lake \n- Autofocus"
      id: 84bf5419-6440-4b3e-82df-6380244ab39d
      iscommand: false
      name: Threat Hunting - Generic
      playbookId: Threat Hunting - Generic
      type: playbook
      version: -1
    taskid: 84bf5419-6440-4b3e-82df-6380244ab39d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 5900
        }
      }
  "70":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ManualThreatHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "56"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c4c13eff-31a0-4970-896f-089eae5fa8f5
      iscommand: false
      name: Continue to manual threat hunting?
      type: condition
      version: -1
    taskid: c4c13eff-31a0-4970-896f-089eae5fa8f5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6535
        }
      }
  "71":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.NeedMoreForensics
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "12"
      "yes":
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e56e0b9b-0f7e-442b-8abe-de1fdf5716de
      iscommand: false
      name: Need more forensics?
      type: condition
      version: -1
    taskid: e56e0b9b-0f7e-442b-8abe-de1fdf5716de
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 190,
          "y": 5220
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "97"
    note: false
    quietmode: 0
    scriptarguments:
      onCall:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Assign analyst to incident.
        By default, the analyst is picked randomly from the available users, according to the provided roles. (If no roles are provided, will fetch all users).
        Otherwise, the analyst will be picked according to the 'assignBy' arguments.
        machine-learning: DBot will calculate and decide who is the best analyst for the job.
        top-user: The user who most commonly owns this type of incident.
        less-busy-user: The less busy analyst will be picked to be the incident owner.
        online: The analyst is picked randomly from all online analysts, according to the provided roles. (If no roles provided, will fetch all users).
        current: The user who executed the command.
      id: 4907a0d7-c451-459b-8cd1-31ac8dc4565e
      iscommand: false
      name: Assign incident to analyst
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: 4907a0d7-c451-459b-8cd1-31ac8dc4565e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3595
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "120"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7816a5d5-7733-4c38-8e41-e48d2fce424f
      iscommand: false
      name: Add the file that caused the FP in the source product to allow list
      type: regular
      version: -1
    taskid: 7816a5d5-7733-4c38-8e41-e48d2fce424f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 4855
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook retrieves forensics from hosts.\nThe available integration
        is Illusive networks. "
      id: 365647a8-d3b4-4e74-8298-099257fa5393
      iscommand: false
      name: Get host forensics - Generic
      playbookId: Get host forensics - Generic
      type: playbook
      version: -1
    taskid: 365647a8-d3b4-4e74-8298-099257fa5393
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 5395
        }
      }
  "77":
    continueonerrortype: ""
    id: "77"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2fe1c876-8652-4ffe-8a73-6a5121ff48a1
      iscommand: false
      name: Manually list detected hostnames
      type: regular
      version: -1
    taskid: 2fe1c876-8652-4ffe-8a73-6a5121ff48a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7055
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    scriptarguments:
      contextKey:
        simple: Threat.Hunting.Detected.Hostsname
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      id: 0c049a0f-9441-4354-844e-78efcf08a7a4
      iscommand: false
      name: Set manual host names
      script: commentsToContext
      type: regular
      version: -1
    taskid: 0c049a0f-9441-4354-844e-78efcf08a7a4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 50,
          "y": 7200
        }
      }
  "79":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.AutoUnIsolation
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b24106f0-5ffe-4bf3-8690-33ac88bee5dd
      iscommand: false
      name: Activated auto unisolation
      type: condition
      version: -1
    taskid: b24106f0-5ffe-4bf3-8690-33ac88bee5dd
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9410
        }
      }
  "80":
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "59"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_ID:
        simple: ${Endpoint.ID}
      Hostname:
        complex:
          accessor: Hostname
          root: Endpoint
          transformers:
          - args:
              item:
                value:
                  simple: Threat.Hunting.Detected.Hostsname
            operator: append
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook unisolates endpoints according to the endpoint ID
        or hostname that is provided in the playbook.\nCurrently supports the following
        integrations:\n- Carbon Black Response\n- Cortex XDR\n- Crowdstrike Falcon\n-
        FireEye HX \n- Cybereason\n"
      id: 2cd99957-df14-43e9-894b-1934e6e9b8cb
      iscommand: false
      name: Unisolate Endpoint - Generic
      playbookId: Unisolate Endpoint - Generic
      type: playbook
      version: -1
    taskid: 2cd99957-df14-43e9-894b-1934e6e9b8cb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 9600
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${inputs.Hostname}
      Endpoint_id:
        simple: ${inputs.Agent_ID}
      Endpoint_ip:
        simple: ${inputs.Endpoint_ip}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook uses the generic command !endpoint to retrieve details
        on specific endpoint.\nThis command currently supports the following integrations:\n-
        Palo Alto Networks Cortex XDR - Investigation and Response.\n- CrowdStrike
        Falcon. "
      id: eac828d4-9564-4bcd-86af-b87572c8f991
      iscommand: false
      name: Get endpoint details - Generic
      playbookId: Get endpoint details - Generic
      type: playbook
      version: -1
    taskid: eac828d4-9564-4bcd-86af-b87572c8f991
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1400
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${Endpoint.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
      ManualHunting.DetectedHosts:
        simple: ${ManualHunting.DetectedHosts}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration that you are using.
      id: 5d327a8d-77ca-4feb-88ca-21b347e7dc8e
      iscommand: false
      name: Isolate Endpoint - Generic V2
      playbookId: Isolate Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 5d327a8d-77ca-4feb-88ca-21b347e7dc8e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 8250
        }
      }
  "95":
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Endpoint.Hostname}
      Endpoint_id:
        simple: ${Endpoint.ID}
      Endpoint_ip:
        simple: ${Endpoint.IPAddress}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This playbook isolates a given endpoint via various endpoint product integrations.
        Make sure to provide the valid playbook input for the integration that you are using.
      id: 02d20f05-ae03-421e-85ba-c72f7a650c2f
      iscommand: false
      name: Isolate Endpoint - Generic V2
      playbookId: Isolate Endpoint - Generic V2
      type: playbook
      version: -1
    taskid: 02d20f05-ae03-421e-85ba-c72f7a650c2f
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 4580
        }
      }
  "97":
    continueonerrortype: ""
    id: "97"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 19b8c7e9-eced-44d2-89be-a8a7dc2cbcc1
      iscommand: false
      name: Isolation
      type: title
      version: -1
    taskid: 19b8c7e9-eced-44d2-89be-a8a7dc2cbcc1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3770
        }
      }
  "98":
    continueonerrortype: ""
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1ae3da7b-6536-4cf2-8d0d-83420c9c786a
      iscommand: false
      name: Forensics
      type: title
      version: -1
    taskid: 1ae3da7b-6536-4cf2-8d0d-83420c9c786a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 190,
          "y": 4960
        }
      }
  "99":
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "79"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dcd42af4-8d84-456b-8cd5-bcd115f04c2b
      iscommand: false
      name: Unisolation
      type: title
      version: -1
    taskid: dcd42af4-8d84-456b-8cd5-bcd115f04c2b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 250,
          "y": 9250
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "52"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: Account.Username
      value:
        complex:
          accessor: user
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 43a725c2-933c-468a-8693-671a59525fc2
      iscommand: false
      name: Set user as account
      script: Set
      type: regular
      version: -1
    taskid: 43a725c2-933c-468a-8693-671a59525fc2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 3205
        }
      }
  "101":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Hostnames
      output:
        simple: ${Threat.Hunting.Detected.Hostsname}
    id: "101"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "102"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Hostsname
      value:
        complex:
          accessor: DetectedInternalHosts
          root: QRadar
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedInternalHosts
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: Splunk.DetectedInternalHosts
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 9bd122d0-4e63-48f2-853e-270a8265a3dd
      iscommand: false
      name: Set detected hostnames to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 9bd122d0-4e63-48f2-853e-270a8265a3dd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6055
        }
      }
  "102":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Detected IPs
      output:
        simple: ${Threat.Hunting.Detected.IP}
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "122"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.IP
      value:
        complex:
          accessor: DetectedInternalIPs
          root: Splunk
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedInternalIPs
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: QRadar.DetectedInternalIPs
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 0a6c6820-57d9-4159-832c-78e2fbd740a0
      iscommand: false
      name: Set detected IP's to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 0a6c6820-57d9-4159-832c-78e2fbd740a0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6210
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 763dd7d6-6294-4d07-8b90-d66c5825fb27
      iscommand: false
      name: No results for manual TH
      type: title
      version: -1
    taskid: 763dd7d6-6294-4d07-8b90-d66c5825fb27
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -160,
          "y": 7710
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "94"
    note: false
    quietmode: 0
    scriptarguments:
      Endpoint_hostname:
        simple: ${Threat.Hunting.Detected.Hostsname}
      Endpoint_id:
        simple: ${EndpointDetails.ID}
      Endpoint_ip:
        simple: ${Threat.Hunting.Detected.IP}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "This playbook uses the generic command !endpoint to retrieve details
        on specific endpoint.\nThis command currently supports the following integrations:\n-
        Palo Alto Networks Cortex XDR - Investigation and Response.\n- CrowdStrike
        Falcon. "
      id: 23055a0b-2235-4dff-800a-065b665e072a
      iscommand: false
      name: Get endpoint details - Generic
      playbookId: Get endpoint details - Generic
      type: playbook
      version: -1
    taskid: 23055a0b-2235-4dff-800a-065b665e072a
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 490,
          "y": 8085
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: Endpoint Hostname,Endpoint ID,Endpoint IP Address,Endpoint Is Isolated,Endpoint
          MAC Address,Endpoint OS,Endpoint Vendor
      context_path:
        simple: Endpoint
      grid_id:
        simple: endpoint
      keys:
        simple: Hostname,ID,IPAddress,IsIsolated,MACAddress,OS,Vendor
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a grid table from items or key-value pairs.
      id: a06156f1-6d06-4b2b-87d5-03efe97592e8
      iscommand: false
      name: Set endpoint details to layout
      script: SetGridField
      type: regular
      version: -1
    taskid: a06156f1-6d06-4b2b-87d5-03efe97592e8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1680
        }
      }
  "110":
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "107"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5b904f95-0950-4c21-8b1a-1fa3a0b23179
      iscommand: false
      name: Set to layout
      type: title
      version: -1
    taskid: 5b904f95-0950-4c21-8b1a-1fa3a0b23179
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1535
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "116"
    note: false
    quietmode: 0
    scriptarguments:
      fieldExactMatch:
        simple: incident.type
      similarTextField:
        simple: incident.parentcmdline,incident.filepaths,incident.cmd
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Find past similar incidents based on incident fields' similarity.
        Includes an option to also display indicators' similarity.
      id: 5a2c5373-42c2-407d-87c7-f571403209b8
      iscommand: false
      name: Find similar incidents
      script: DBotFindSimilarIncidents
      type: regular
      version: -1
    taskid: 5a2c5373-42c2-407d-87c7-f571403209b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 340
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "118"
    note: false
    quietmode: 0
    scriptarguments:
      columns:
        simple: Incident Id,Created,Name,Similarity Incident,Parent CMD line,File
          path,Command line
      context_path:
        simple: DBotFindSimilarIncidents.similarIncident(val.id='#/Details/'+val.id,val.parentcmdline=val.parentcmdline.join(','),val.filepaths=val.filepaths.join(','),val.cmd=val.cmd.join(','))
      grid_id:
        simple: similarincidentsdbot
      keys:
        simple: id,created,name,similarity incident,parentcmdline,filepaths,cmd
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a grid table from items or key-value pairs.
      id: 9d8d868f-6864-4015-8d74-0302c32a211e
      iscommand: false
      name: Set similar incidents to layout
      script: SetGridField
      type: regular
      version: -1
    taskid: 9d8d868f-6864-4015-8d74-0302c32a211e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 690
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "111"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 29604f70-1c3a-471e-8c4d-ccdb78a8f845
      iscommand: false
      name: Find similar incidents
      type: title
      version: -1
    taskid: 29604f70-1c3a-471e-8c4d-ccdb78a8f845
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 195
        }
      }
  "114":
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 909e0c7f-6139-43f6-85fd-6def8a1f2a86
      iscommand: false
      name: Get endpoint details
      type: title
      version: -1
    taskid: 909e0c7f-6139-43f6-85fd-6def8a1f2a86
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 490,
          "y": 1275
        }
      }
  "115":
    continueonerrortype: ""
    id: "115"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        simple: "No"
      CustomBlockRule:
        simple: "True"
      CustomURLCategory:
        simple: Demisto Remediation - Malicious URLs
      IP:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: ip
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      MD5:
        complex:
          accessor: MD5
          root: File
      SHA256:
        complex:
          accessor: SHA256
          root: File
      URL:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: url
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
          transformers:
          - operator: uniq
      URLListName:
        simple: Demisto Remediation - URL EDL
      Username:
        complex:
          accessor: Indicator
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: DBotScore.Type
              operator: isEqualString
              right:
                value:
                  simple: username
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: greaterThanOrEqual
              right:
                value:
                  simple: "3"
          root: DBotScore
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |+
        This playbook blocks malicious indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic
        - Block Account - Generic
        - Block IP - Generic v2
        - Block File - Generic v2

      id: e94644e3-d061-4e6b-8973-590df8adae40
      iscommand: false
      name: Block Indicators - Generic v2
      playbookId: Block Indicators - Generic v2
      type: playbook
      version: -1
    taskid: e94644e3-d061-4e6b-8973-590df8adae40
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -20,
          "y": 8730
        }
      }
  "116":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: DBotFindSimilarIncidents.similarIncident
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "116"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "114"
      "yes":
      - "112"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6d5cf61e-09ab-4857-8533-32c1d08bb10d
      iscommand: false
      name: Are there similar incidents?
      type: condition
      version: -1
    taskid: 6d5cf61e-09ab-4857-8533-32c1d08bb10d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 515
        }
      }
  "117":
    continueonerrortype: ""
    id: "117"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "114"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
      linkedIncidentIDs:
        simple: ${DBotFindSimilarIncidents.similarIncident.id}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.linkIncidents
      id: bb06ba49-d954-4c69-8cd0-d65a7ff7f1bc
      iscommand: true
      name: Link similar incidents
      script: Builtin|||linkIncidents
      type: regular
      version: -1
    taskid: bb06ba49-d954-4c69-8cd0-d65a7ff7f1bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 960,
          "y": 1070
        }
      }
  "118":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.LinkSimilarIncidents
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "118"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "114"
      "yes":
      - "117"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3bad3572-9375-4c3d-8f37-a60e87e0e05b
      iscommand: false
      name: Link the similar events?
      type: condition
      version: -1
    taskid: 3bad3572-9375-4c3d-8f37-a60e87e0e05b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 960,
          "y": 855
        }
      }
  "119":
    continueonerrortype: ""
    id: "119"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "57"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: 52c0f4ad-1a2c-4ec4-8126-6a114ef4e3b8
      iscommand: true
      name: Close investigation as false positive
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 52c0f4ad-1a2c-4ec4-8126-6a114ef4e3b8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 10140
        }
      }
  "120":
    continueonerrortype: ""
    id: "120"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "119"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Close the incident in the source product that triggered it.
      id: 1f4a9eda-ee6b-416f-8ed5-45249e78306a
      iscommand: false
      name: Manual - Close incident in the source product
      type: regular
      version: -1
    taskid: 1f4a9eda-ee6b-416f-8ed5-45249e78306a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -670,
          "y": 5090
        }
      }
  "121":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Specify the closing reason
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: shortText
      sender: ""
      title: Closing reason
      totalanswers: 0
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: {}
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 26a09e70-28bb-4d81-82e7-c9b8d6ed2aa9
      iscommand: false
      name: Closing reason
      type: collection
      version: -1
    taskid: 26a09e70-28bb-4d81-82e7-c9b8d6ed2aa9
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -220,
          "y": 9970
        }
      }
  "122":
    continueonerrortype: ""
    fieldMapping:
    - incidentfield: Detected User
      output:
        simple: ${Threat.Hunting.Detected.Users}
    id: "122"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: Threat.Hunting.Detected.Users
      value:
        complex:
          accessor: DetectedUsers
          root: Splunk
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: PANWHunting.DetectedUsers
            operator: append
          - args:
              item:
                iscontext: true
                value:
                  simple: QRadar.DetectedUsers
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script doesn't do anything.
      id: 1b3531d3-f0ff-47a3-83f9-18419e145bd4
      iscommand: false
      name: Set detected users to to context
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 1b3531d3-f0ff-47a3-83f9-18419e145bd4
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 490,
          "y": 6370
        }
      }
  "123":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.DetonateFile
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "123"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "100"
      "yes":
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ff7cf243-6be0-4645-89f3-70362e002d28
      iscommand: false
      name: Activate auto detonation?
      type: condition
      version: -1
    taskid: ff7cf243-6be0-4645-89f3-70362e002d28
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2685
        }
      }
  "124":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.IsolationAfterHunting
          operator: isEqualString
          right:
            value:
              simple: "Yes"
      label: "yes"
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "104"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: dc44ef06-4859-4ad7-8d81-a9f3b26484fe
      iscommand: false
      name: Activate auto isolation after threat hunting?
      type: condition
      version: -1
    taskid: dc44ef06-4859-4ad7-8d81-a9f3b26484fe
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 490,
          "y": 7840
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "116_112_yes": 0.53,
      "116_114_#default#": 0.32,
      "118_114_#default#": 0.83,
      "118_117_yes": 0.68,
      "123_100_#default#": 0.64,
      "123_28_yes": 0.56,
      "124_104_yes": 0.63,
      "19_115_Yes": 0.53,
      "19_41_No": 0.58,
      "36_123_yes": 0.53,
      "36_37_#default#": 0.64,
      "39_77_Yes": 0.49,
      "46_98_No": 0.51,
      "50_46_#default#": 0.66,
      "50_95_yes": 0.49,
      "51_45_False positive": 0.67,
      "51_50_Continue Investigation ": 0.58,
      "56_55_yes": 0.6,
      "56_66_#default#": 0.51,
      "71_12_#default#": 0.51,
      "79_21_#default#": 0.64
    },
    "paper": {
      "dimensions": {
        "height": 10365,
        "width": 2210,
        "x": -670,
        "y": 50
      }
    }
  }
