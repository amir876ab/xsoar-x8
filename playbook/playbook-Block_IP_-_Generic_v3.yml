contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 2.4.13
    packID: CommonPlaybooks
    packName: Common Playbooks
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: "This playbook blocks malicious IP addresses using all integrations that
  are enabled. The direction of the traffic that will be blocked is determined by
  the XSOAR user (and set by default to outgoing)\nNote the following:\n-  some of
  those integrations require specific parameters to run, which are based on the playbook
  inputs. Also, certain integrations use FW rules or appended network objects.\n-
  Note that the appended network objects should be specified in blocking rules inside
  the system later on. \n\n\nSupported integrations for this playbook [Network security
  products such as FW/WAF/IPs/etc.]: \n\n* Check Point Firewall\n* Palo Alto Networks
  PAN-OS\n* Zscaler\n* FortiGate\n* Aria Packet Intelligence\n* Cisco Firepower \n*
  Cisco Secure Cloud Analytics\n* Cisco ASA\n* Akamai WAF\n* F5 SilverLine\n* ThreatX\n*
  Signal Sciences WAF\n* Sophos Firewall\n\n"
id: Block IP - Generic v3
inputs:
- description: 'An array of malicious IPs to block. Enter a comma-separated list of
    IPs (i.e.: 1.1.1.1,2.2.2.2).'
  key: IP
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input determines whether Palo Alto Networks Panorama or Firewall
    Custom Block Rules are used.\nSpecify \"True\" to create new Custom Block Rules
    (2 FW rules inside the PAN-OS device). \nFor \"False\" - no rules will be created."
  key: CustomBlockRule
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: Panorama log forwarding object name. Indicate what type of Log Forwarding
    setting will be specified in the PAN-OS custom rules.
  key: LogForwarding
  playbookInputQuery: null
  required: false
  value: {}
- description: "This input determines whether to commit the configuration automatically
    on PAN-OS devices and other FWs. \nYes - Commit automatically.\nNo - Commit manually."
  key: AutoCommit
  playbookInputQuery: null
  required: false
  value:
    simple: "No"
- description: |-
    This input determines whether Palo Alto Networks Panorama or Firewall Static Address Groups are used.
    Specify the Static Address Group name for IPs list handling.
  key: StaticAddressGroup
  playbookInputQuery: null
  required: false
  value: {}
- description: Insert a tag name with which indicators will get tagged. This tag can
    be used later in the External Dynamic Lists integration by using the tag for filtering
    IPs in the indicator query.
  key: Tag
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    This input determines whether Palo Alto Networks Panorama or Firewall Dynamic Address Groups are used.
    Determine the Dynamic Address Group tag for IPs list handling.
  key: DAG
  playbookInputQuery: null
  required: false
  value: {}
- description: "Possible values: True/False.  Default: True.\nWhether to provide user
    verification for blocking those IPs. \n\nFalse - No prompt will be displayed to
    the user.\nTrue - The server will ask the user for blocking verification and will
    display the blocking list."
  key: UserVerification
  playbookInputQuery: null
  required: false
  value:
    simple: "True"
- description: 'A list of internal IP ranges to check IP addresses against. The list
    should be provided in CIDR notation, separated by commas. An example of a list
    of ranges would be: "172.16.0.0/12,10.0.0.0/8,192.168.0.0/16" (without quotes).
    If a list is not provided, will use the default list provided in the IsIPInRanges
    script (the known IPv4 private address ranges).'
  key: InternalRange
  playbookInputQuery: null
  required: false
  value: {}
- description: Signal Sciences WAF - Enter the site name for the integration to be
    applied. The site name can be found in your instance console.
  key: SiteName
  playbookInputQuery: null
  required: false
  value: {}
- description: Akamai's WAF network list ID, which is mandatory to be mentioned for
    the integration. The chosen IPs will be added to this ID.
  key: AkamaiNetworkListID
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    Possible values: True/False . Default: False
    Enrich the input IP address/es with reputation commands.
  key: InputEnrichment
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: |-
    The rule name/description that will be presented on the created rule in certain integrations (if there is a need).
    The supported integrations: PAN-OS, CheckPoint.

    Default input- "XSOAR - Block IP playbook - ${incident.id}"
  key: RuleName
  playbookInputQuery: null
  required: false
  value:
    simple: XSOAR - Block IP playbook - ${incident.id}
- description: |-
    Determine if a newly created rule should be with the network direction of outbound or inbound blocked traffic.
    Possible values: inbound or outbound
    Default: outbound
  key: RuleDirection
  playbookInputQuery: null
  required: false
  value:
    simple: outbound
- description: |-
    This input determines whether Palo Alto Networks Panorama or Firewall Dynamic Address Groups are used.
    Determine the Dynamic Address Group name for IPs list handling.
  key: DAGName
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    For prisma SASE usage - Specify the scope for a newly created security rule to be applied.
    Remember, this input will only be used when there is no input to the CategoryName.
    Default: Shared
  key: Folder
  playbookInputQuery: null
  required: false
  value:
    simple: Shared
name: Block IP - Generic v3
outputs:
- contextPath: Aria.BlockDestSubnet.Rule
  description: The rule name/ID which was created in the system for this playbook.
  type: unknown
- contextPath: Aria.BlockDestSubnet.Status
  description: The status of the command that created the rule above.
  type: unknown
- contextPath: Stealthwatch.IP.id
  description: The ID of the object created in Cisco Secure Cloud Analytics.
  type: unknown
- contextPath: Stealthwatch.IP.identifier
  description: The value of the object created in Cisco Secure Cloud Analytics.
  type: unknown
- contextPath: CiscoASA.Rules.ID
  description: The rule ID that was created in Cisco ASA for this playbook.
  type: unknown
- contextPath: CiscoASA.Rules.Source
  description: The rule's source object that was set in the associated rule.
  type: unknown
- contextPath: CiscoASA.Rules.Dest
  description: The rule's destination object that was set in the associated rule.
  type: unknown
- contextPath: CiscoASA.Rules.IsActive
  description: The rule's state that was set in the associated rule.
  type: unknown
- contextPath: SigSciences.Corp.Site.Blacklist.ID
  description: Signal Sciences created rule ID.
  type: unknown
- contextPath: SigSciences.Corp.Site.Blacklist.Source
  description: Signal Sciences blocked address in a dedicated rule.
  type: unknown
- contextPath: SigSciences.Corp.Site.Blacklist.CreatedBy
  description: Signal Sciences - the blocking rule's creator name.
  type: unknown
- contextPath: PrismaSase
  description: The root context key for Prisma SASE integration output.
  type: unknown
- contextPath: PrismaSase.AddressGroup
  description: The Prisma Access Address group object.
  type: unknown
- contextPath: PrismaSase.SecurityRule
  description: Created security rule.
- contextPath: PrismaSase.SecurityRule.profile_setting
  description: The Security rule group object in the rule.
  type: unknown
- contextPath: PrismaSase.CandidateConfig
  description: Configuration job object.
  type: unknown
- contextPath: PrismaSase.Address
  description: Created address object.
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "36"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b7fe6f18-9640-4161-87bd-c1ac609bf72d
      iscommand: false
      name: ""
      version: -1
    taskid: b7fe6f18-9640-4161-87bd-c1ac609bf72d
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 120
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: eec033f1-46ff-4c08-886b-5622e622aa85
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: eec033f1-46ff-4c08-886b-5622e622aa85
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 4325
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
      - "18"
      - "20"
      - "26"
      - "30"
      - "55"
      - "60"
      - "64"
      - "63"
      - "67"
      - "71"
      - "79"
      - "74"
      - "104"
      - "106"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 034d4a0b-ba68-4b79-80b6-def530a3ef4a
      iscommand: false
      name: Block IPs
      type: title
      version: -1
    taskid: 034d4a0b-ba68-4b79-80b6-def530a3ef4a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 3645
        }
      }
  "7":
    continueonerrortype: ""
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "29"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: CheckPointFirewall_v2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 3bfa1467-a97a-40e5-8795-aa2f8cd34a56
      iscommand: false
      name: Is Check Point Firewall enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 3bfa1467-a97a-40e5-8795-aa2f8cd34a56
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1662.5,
          "y": 3945
        }
      }
  "8":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: BlockList.Input
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: BlockList.Malicious
          operator: isExists
        - left:
            iscontext: true
            value:
              simple: BlockList.Suspicious
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "96"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verify that there is at least one IP to block.
      id: a711453b-2850-4493-8a69-a51cdaba5962
      iscommand: false
      name: Is there an IP to block?
      type: condition
      version: -1
    taskid: a711453b-2850-4493-8a69-a51cdaba5962
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 2020
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "13"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Zscaler
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 6d71d465-7c2e-43d8-8367-04945ca4c3c3
      iscommand: false
      name: Is Zscaler enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 6d71d465-7c2e-43d8-8367-04945ca4c3c3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1212.5,
          "y": 3945
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: true
    task:
      brand: Zscaler
      description: Block the IPs using Zscaler.
      id: 9a4954bd-d057-437b-8d85-28c5a3ec7728
      iscommand: true
      name: Block IP with Zscaler
      script: Zscaler|||zscaler-blacklist-ip
      type: regular
      version: -1
    taskid: 9a4954bd-d057-437b-8d85-28c5a3ec7728
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1100,
          "y": 4120
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      IP:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - operator: uniq
      LogForwarding:
        complex:
          root: inputs.LogForwarding
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook blocks IP addresses using Custom Block Rules in Palo Alto Networks Panorama or Firewall.
        The playbook receives malicious IP addresses as inputs, creates a custom bi-directional rule to block them, and commits the configuration.
      id: 3bd3ff6a-1dda-4a72-8f94-de4b25140a1b
      iscommand: false
      name: PAN-OS - Block IP - Custom Block Rule
      playbookId: PAN-OS - Block IP - Custom Block Rule
      type: playbook
      version: -1
    taskid: 3bd3ff6a-1dda-4a72-8f94-de4b25140a1b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -2900,
          "y": 4120
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      AddressGroupName:
        complex:
          root: inputs.StaticAddressGroup
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      IP:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook blocks IP addresses using Static Address Groups in Palo Alto Networks Panorama or Firewall.
        The playbook receives malicious IP addresses and an address group name as inputs, verifies that the addresses are not already a part of the address group, adds them and commits the configuration.

        ***Note - The playbook does not block the address group communication using a policy block rule. This step will be taken once outside of the playbook.
      id: db15c8b3-8d89-4217-89d1-50f93161fd5e
      iscommand: false
      name: PAN-OS - Block IP - Static Address Group
      playbookId: PAN-OS - Block IP - Static Address Group
      type: playbook
      version: -1
    taskid: db15c8b3-8d89-4217-89d1-50f93161fd5e
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -2450,
          "y": 4120
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
      - "23"
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 90146620-3c96-420d-8abb-c4e43df36c6c
      iscommand: false
      name: PAN-OS
      type: title
      version: -1
    taskid: 90146620-3c96-420d-8abb-c4e43df36c6c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2665,
          "y": 3790
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bd4b2c1c-a1aa-4d90-87f0-2e11be406424
      iscommand: false
      name: CheckPoint FW
      type: title
      version: -1
    taskid: bd4b2c1c-a1aa-4d90-87f0-2e11be406424
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1662.5,
          "y": 3790
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: a7c00656-a5e1-4199-898d-adef07c33467
      iscommand: false
      name: Zscaler
      type: title
      version: -1
    taskid: a7c00656-a5e1-4199-898d-adef07c33467
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1212.5,
          "y": 3790
        }
      }
  "21":
    continueonerrortype: ""
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      action-type:
        simple: drop
      address_group_name:
        complex:
          root: inputs.DAGName
      auto_commit:
        complex:
          root: inputs.AutoCommit
      inbound-or-outbound-rule:
        complex:
          root: inputs.RuleDirection
      ip_list:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - operator: uniq
      pre-post-rulebase:
        simple: pre-rulebase
      rule-position:
        simple: top
      tag_name:
        complex:
          root: inputs.DAG
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: "This playbook utilizes the Dynamic Address Group (DAG) capability
        of PAN-OS.\nDAG enables analysts to create a rule one time, where the group
        is the source/destination, and adds IP addresses dynamically without the need
        to commit the configuration every time.\n\nThe playbook checks if the given
        tag already exists. If the tag exists, then the IP address is added to the
        tag.\n\nIf the tag does not exist, a new address group is created with the
        given tag and a matching rule, and the configuration is committed. \n"
      id: 0e68ca31-6c08-4918-8ed2-6da4bd98c940
      iscommand: false
      name: PAN-OS DAG Configuration
      playbookId: PAN-OS DAG Configuration
      type: playbook
      version: -1
    taskid: 0e68ca31-6c08-4918-8ed2-6da4bd98c940
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -2000,
          "y": 4120
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.CustomBlockRule
                transformers:
                - operator: toLowerCase
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verify if custom block rule playbook input is set to true.
      id: 1cee05c9-29eb-4552-8833-d3670680620c
      iscommand: false
      name: Use Custom Block Rules?
      type: condition
      version: -1
    taskid: 1cee05c9-29eb-4552-8833-d3670680620c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -3012.5,
          "y": 3945
        }
      }
  "23":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.StaticAddressGroup
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "15"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verify if there is a static address group name set as a playbook
        input.
      id: b141c107-3022-489f-8635-6907ad4240ee
      iscommand: false
      name: Use Static Address Group?
      type: condition
      version: -1
    taskid: b141c107-3022-489f-8635-6907ad4240ee
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2562.5,
          "y": 3945
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.Tag
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "103"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verify if there is a tag to mark IPs for an EDL/EIS query.
      id: 9eed4e5a-b732-4394-8264-05f071e51aeb
      iscommand: false
      name: Use External Dynamic List?
      type: condition
      version: -1
    taskid: 9eed4e5a-b732-4394-8264-05f071e51aeb
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 4347.5,
          "y": 3925
        }
      }
  "25":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.DAG
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verify if there is a dynamic address group name set as a playbook
        input.
      id: f9198f7e-933d-4c93-82c5-d516fdd9ef0c
      iscommand: false
      name: Use Dynamic Address Group?
      type: condition
      version: -1
    taskid: f9198f7e-933d-4c93-82c5-d516fdd9ef0c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2112.5,
          "y": 3945
        }
      }
  "26":
    continueonerrortype: ""
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: db18a7c0-26ec-4316-8730-c19da3847291
      iscommand: false
      name: Fortinet
      type: title
      version: -1
    taskid: db18a7c0-26ec-4316-8730-c19da3847291
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -762.5,
          "y": 3790
        }
      }
  "27":
    continueonerrortype: ""
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "28"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: FortiGate
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 380e319e-a726-4445-84c7-b8c667f073d0
      iscommand: false
      name: Is FortiGate enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 380e319e-a726-4445-84c7-b8c667f073d0
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -762.5,
          "y": 3945
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      ip_address:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - operator: uniq
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Adds IP addresses to the banned list.
      id: a330da1e-f166-48cd-8eaa-06177aee8efe
      iscommand: true
      name: 'FortiGate Ban IP '
      script: '|||fortigate-ban-ip'
      type: regular
      version: -1
    taskid: a330da1e-f166-48cd-8eaa-06177aee8efe
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -650,
          "y": 4120
        }
      }
  "29":
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        simple: ${BlockList.Final}
      block_IP_error_handling:
        simple: Stop
      checkpoint_error_handling:
        simple: Stop
      install_policy:
        complex:
          root: inputs.AutoCommit
          transformers:
          - args:
              condition: {}
              else:
                value:
                  simple: "False"
              equals:
                value:
                  simple: "Yes"
              lhs: {}
              options: {}
              rhs: {}
              then:
                value:
                  simple: "True"
            operator: If-Then-Else
      policy_package:
        simple: Standard
      rule_layer:
        simple: Network
      rule_name:
        simple: ${inputs.RuleName}
      rule_position:
        simple: top
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook blocks IP addresses using Custom Block Rules in Checkpoint Firewall.
        The playbook receives malicious IP addresses as inputs, creates a custom bi-directional rule to block them, and publishes the configuration.
      id: e306cb07-b682-40af-8644-632cde5aa588
      iscommand: false
      name: Checkpoint - Block IP - Custom Block Rule
      playbookName: Checkpoint - Block IP - Custom Block Rule
      type: playbook
      version: -1
    taskid: e306cb07-b682-40af-8644-632cde5aa588
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1550,
          "y": 4120
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a69e369-2577-45fb-83dd-75125547a4ab
      iscommand: false
      name: F5 Silverline
      type: title
      version: -1
    taskid: 4a69e369-2577-45fb-83dd-75125547a4ab
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -312.5,
          "y": 3790
        }
      }
  "31":
    continueonerrortype: ""
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      cidr_range:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      list_type:
        simple: denylist
      note:
        simple: ${inputs.RuleName}
    separatecontext: false
    skipunavailable: true
    task:
      brand: F5Silverline
      description: Adds a new particular threatening IP address object by its IP address.
      id: 80d38ccf-d4ba-41c4-8ebd-26a30da58266
      iscommand: true
      name: 'F5 Silverline - add IP to deny list '
      script: F5Silverline|||f5-silverline-ip-object-add
      type: regular
      version: -1
    taskid: 80d38ccf-d4ba-41c4-8ebd-26a30da58266
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -200,
          "y": 4120
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "31"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: F5Silverline
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: df579a8d-7184-4b88-8beb-352e000cd072
      iscommand: false
      name: Is F5 Silverline enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: df579a8d-7184-4b88-8beb-352e000cd072
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -312.5,
          "y": 3945
        }
      }
  "36":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: inputs.IP
                    operator: match
                    right:
                      value:
                        simple: (\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}
                root: inputs.IP
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "36"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "80"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there are any IPs mentioned in the inputs section.
      id: ca84bd8d-a8f0-4627-8afe-61e0e70ff4d5
      iscommand: false
      name: Are there IPs in Inputs?
      type: condition
      version: -1
    taskid: ca84bd8d-a8f0-4627-8afe-61e0e70ff4d5
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 280
        }
      }
  "41":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Address
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: IP.Malicious
                    operator: isExists
                root: IP
                transformers:
                - operator: uniq
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "42"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there are any malicious IPs from the input IPs.
      id: 1c174167-6aa9-48c5-8c77-7b6ddfa3527a
      iscommand: false
      name: Are there any Malicious IPs?
      type: condition
      version: -1
    taskid: 1c174167-6aa9-48c5-8c77-7b6ddfa3527a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1580
        }
      }
  "42":
    continueonerrortype: ""
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.Malicious
      value:
        complex:
          accessor: Address
          filters:
          - - left:
                iscontext: true
                value:
                  simple: IP.Malicious
              operator: isExists
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: IP.Address
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.IP
          root: IP
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      id: 31af9dac-9fc4-477e-87b4-19fe4da82447
      iscommand: false
      name: Append Context List with IPs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 31af9dac-9fc4-477e-87b4-19fe4da82447
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1795
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0f39089b-9326-4a78-8de3-ec670ec8683d
      iscommand: false
      name: User Verification Prompt
      type: title
      version: -1
    taskid: 0f39089b-9326-4a78-8de3-ec670ec8683d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 2265
        }
      }
  "44":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.UserVerification
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "86"
      "yes":
      - "95"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if user verification is needed. Otherwise, proceed without
        asking questions.
      id: d3e2ec0f-17f8-4905-8a2e-cffb29513a53
      iscommand: false
      name: Is User Verification required?
      type: condition
      version: -1
    taskid: d3e2ec0f-17f8-4905-8a2e-cffb29513a53
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 2410
        }
      }
  "45":
    continueonerrortype: ""
    form:
      description: Please note that there are Internal IPs in this form!
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Do you approve the blocking request for "Malicious IPs"?
        options: []
        optionsarg:
        - complex:
            accessor: Malicious
            root: BlockList
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Do you approve the blocking request for "Suspicious IPs"?
        options: []
        optionsarg:
        - complex:
            accessor: Suspicious
            root: BlockList
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Do you approve the blocking request for "Other IPs from Input"?
        options: []
        optionsarg:
        - complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: BlockList.Input
                operator: notIn
                right:
                  iscontext: true
                  value:
                    simple: BlockList.Suspicious
            - - ignorecase: true
                left:
                  iscontext: true
                  value:
                    simple: BlockList.Input
                operator: notIn
                right:
                  iscontext: true
                  value:
                    simple: BlockList.Malicious
            - - ignorecase: true
                left:
                  iscontext: true
                  value:
                    simple: BlockList.Input
                operator: notIn
                right:
                  iscontext: true
                  value:
                    simple: BlockList.PIIP
            root: BlockList.Input
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "3"
        label: ""
        labelarg:
          simple: Do you approve the blocking request or "Internal Address"?
        options: []
        optionsarg:
        - complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: BlockList.PIIP
                operator: notIn
                right:
                  iscontext: true
                  value:
                    simple: BlockList.Suspicious
            - - ignorecase: true
                left:
                  iscontext: true
                  value:
                    simple: BlockList.PIIP
                operator: notIn
                right:
                  value:
                    simple: BlockList.Malicious
            root: BlockList.PIIP
            transformers:
            - operator: uniq
        - {}
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: Your SOC team
      title: Please answer the following
      totalanswers: 0
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: |-
          <p>Dear XSOAR user,</p>
          <p>This notification informs you that the following list of IPs will be blocked on your XSOAR's integrated network devices.</p>
          <p><br />(<strong>Note</strong>: the IPs will be added to your company block list or be blocked in individual rules based on the XSOAR integrated devices).</p>
          <p>Also, <strong>please note</strong> that the following IPs are part of the <strong>internal range</strong> mentioned in the playbook:</p>
          <p>${BlockList.PIIP}</p>
          <p>&nbsp;</p>
          <p>For more information, click the link below.</p>
      cc:
        simple: Administrator
      format: html
      methods:
      - email
      subject:
        simple: Block IP Playbook - Analyst's Verification
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst,Administrator
    nexttasks:
      '#none#':
      - "102"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Ask the user what IPs should be blocked.
        Note that in this task the following IPs are in your internal range:
        ${BlockList.PIIP}

        Remember that the direction you have decided is - ${inputs.RuleDirection}
      id: 4e143a2c-ef50-41f1-807d-088c46e5a538
      iscommand: false
      name: 'Analyst Verification Prompt '
      type: collection
      version: -1
    taskid: 4e143a2c-ef50-41f1-807d-088c46e5a538
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1532.5,
          "y": 2770
        }
      }
  "47":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Score
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: DBotScore.Indicator
                    operator: match
                    right:
                      value:
                        simple: (\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}
                - - left:
                      iscontext: true
                      value:
                        simple: DBotScore.Indicator
                    operator: inList
                    right:
                      iscontext: true
                      value:
                        simple: inputs.IP
                root: DBotScore
          operator: isEqualString
          right:
            value:
              simple: "2"
      label: "YES"
    continueonerrortype: ""
    id: "47"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "YES":
      - "48"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if any suspicious IPs were found during the IP enrichment
        process.
      id: 41d0d39e-008f-438e-82c2-b5af7781eabf
      iscommand: false
      name: Are there any Suspicious IPs?
      type: condition
      version: -1
    taskid: 41d0d39e-008f-438e-82c2-b5af7781eabf
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1580
        }
      }
  "48":
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.Suspicious
      stringify:
        simple: "false"
      value:
        complex:
          accessor: Indicator
          filters:
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Score
              operator: isEqualString
              right:
                value:
                  simple: "2"
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Indicator
              operator: match
              right:
                value:
                  simple: (\b25[0-5]|\b2[0-4][0-9]|\b[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}
          - - left:
                iscontext: true
                value:
                  simple: DBotScore.Indicator
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.IP
          root: DBotScore
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      id: 24d37c7e-dfc9-4075-8caf-fac89448f74f
      iscommand: false
      name: Append Context List with IPs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 24d37c7e-dfc9-4075-8caf-fac89448f74f
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1795
        }
      }
  "51":
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "41"
      - "47"
      - "85"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1dd62435-07b9-4e9a-86db-7a900c3dbd4e
      iscommand: false
      name: Finalize Verdict For IP/s
      type: title
      version: -1
    taskid: 1dd62435-07b9-4e9a-86db-7a900c3dbd4e
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1440
        }
      }
  "53":
    continueonerror: true
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "100"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      indicatorsValues:
        complex:
          accessor: Address
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "No"
          - - left:
                iscontext: true
                value:
                  simple: IP.Address
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.IP
          root: IP
    separatecontext: false
    skipunavailable: true
    task:
      brand: Builtin
      description: commands.local.cmd.enrich.indicators
      id: d7d90e83-062b-4455-889d-7289d1a70a19
      iscommand: true
      name: Enrich Indicators
      script: Builtin|||enrichIndicators
      type: regular
      version: -1
    taskid: d7d90e83-062b-4455-889d-7289d1a70a19
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 1080
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b56affc3-dc5f-4463-8599-d308363152bf
      iscommand: false
      name: Cisco ASA
      type: title
      version: -1
    taskid: b56affc3-dc5f-4463-8599-d308363152bf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 3790
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "57"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Cisco ASA
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: c8b3752a-ee90-47fb-888f-f8e9dbc3f15f
      iscommand: false
      name: Is Cisco ASA enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: c8b3752a-ee90-47fb-888f-f8e9dbc3f15f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": 3940
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      active:
        complex:
          root: inputs.AutoCommit
          transformers:
          - args:
              condition: {}
              else:
                value:
                  simple: "False"
              equals:
                value:
                  simple: "Yes"
              lhs: {}
              options: {}
              rhs: {}
              then:
                value:
                  simple: Ture
            operator: If-Then-Else
      destination:
        complex:
          root: inputs.RuleDirection
          transformers:
          - args:
              condition: {}
              else:
                value:
                  simple: 0.0.0.0
              equals:
                value:
                  simple: outbound
              lhs: {}
              options: {}
              rhs: {}
              then:
                iscontext: true
                value:
                  simple: ${BlockList.Final}
            operator: If-Then-Else
      interface_type:
        simple: Global
      log_level:
        simple: Default
      permit:
        simple: "False"
      position:
        simple: top
      source:
        complex:
          root: inputs.RuleDirection
          transformers:
          - args:
              condition: {}
              else:
                iscontext: true
                value:
                  simple: ${BlockList.Final}
              equals:
                value:
                  simple: outbound
              lhs: {}
              options: {}
              rhs: {}
              then:
                value:
                  simple: 0.0.0.0
            operator: If-Then-Else
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Creates a rule.
      id: 09577124-dd9f-40db-8c88-5b872a06e38d
      iscommand: true
      name: Cisco ASA - Create Blocking Rule
      script: '|||cisco-asa-create-rule'
      type: regular
      version: -1
    taskid: 09577124-dd9f-40db-8c88-5b872a06e38d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 410,
          "y": 4100
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "59"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Stealthwatch Cloud
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 8f019569-55db-4d45-8642-52e45dba3c2d
      iscommand: false
      name: Is Cisco Secure Cloud Analytics enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 8f019569-55db-4d45-8642-52e45dba3c2d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 747.5,
          "y": 3935
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Add a domain or IP to the block list.
      id: 6099cfca-ecd9-4dfc-8720-c806a21e43b6
      iscommand: true
      name: Cisco Secure Cloud Analytics - Add IP to Block List
      script: '|||sw-block-domain-or-ip'
      type: regular
      version: -1
    taskid: 6099cfca-ecd9-4dfc-8720-c806a21e43b6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 860,
          "y": 4110
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: bd27b51c-e1cd-4371-8dfc-2d6d49c6c08c
      iscommand: false
      name: Cisco Secure Cloud Analytics
      type: title
      version: -1
    taskid: bd27b51c-e1cd-4371-8dfc-2d6d49c6c08c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 747.5,
          "y": 3790
        }
      }
  "61":
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "89"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Cisco Firepower
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: ff341c4e-cd9b-4516-8d8a-b6f2f97b30c4
      iscommand: false
      name: Is Cisco Firepower enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: ff341c4e-cd9b-4516-8d8a-b6f2f97b30c4
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1647.5,
          "y": 3935
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "61"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9dac0912-fb55-4a3b-8d68-ebd2cdde784f
      iscommand: false
      name: 'Cisco Firepower '
      type: title
      version: -1
    taskid: 9dac0912-fb55-4a3b-8d68-ebd2cdde784f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1647.5,
          "y": 3790
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7605a78c-deb2-4a39-8a51-e42950bf736c
      iscommand: false
      name: Akamai WAF
      type: title
      version: -1
    taskid: 7605a78c-deb2-4a39-8a51-e42950bf736c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1197.5,
          "y": 3790
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "66"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Akamai WAF
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: fdd8bddf-f40f-4e35-8bb4-ef79df9f4d8a
      iscommand: false
      name: Is Akamai WAF enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: fdd8bddf-f40f-4e35-8bb4-ef79df9f4d8a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1197.5,
          "y": 3935
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      elements:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      network_list_id:
        simple: ${inputs.AkamaiNetworkListID}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Adds elements to the specified network list.
      id: b9da42f6-1e62-4ac7-8e2b-01c458855259
      iscommand: true
      name: Akamai WAF - Add IP to a block list
      script: '|||akamai-add-elements-to-network-list'
      type: regular
      version: -1
    taskid: b9da42f6-1e62-4ac7-8e2b-01c458855259
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 4110
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9688c755-ae0b-4dfa-8751-c927f6d7ae38
      iscommand: false
      name: ThreatX
      type: title
      version: -1
    taskid: 9688c755-ae0b-4dfa-8751-c927f6d7ae38
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2460,
          "y": 3790
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "69"
      - "93"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: ThreatX
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: cffe6cff-03f5-43cc-89e9-c6b083ae4b53
      iscommand: false
      name: Is ThreatX enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: cffe6cff-03f5-43cc-89e9-c6b083ae4b53
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2460,
          "y": 3925
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: ${inputs.RuleName}
      ip:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Temporarily blocks an IP address or CIDR. Default is 30 minutes.
      id: 88e12722-0ed7-4636-8563-5a72a90c6d38
      iscommand: true
      name: ThreatX - Block IP for 30 min
      script: '|||threatx-block-ip'
      type: regular
      version: -1
    taskid: 88e12722-0ed7-4636-8563-5a72a90c6d38
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2210,
          "y": 4110
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 53ea2c9b-dacb-456e-8c02-683e777bae76
      iscommand: false
      name: 'Signal Sciences WAF '
      type: title
      version: -1
    taskid: 53ea2c9b-dacb-456e-8c02-683e777bae76
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2997.5,
          "y": 3790
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "73"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Signal Sciences WAF
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: e18ed541-babe-4ecf-85f9-d021aa99a0a9
      iscommand: false
      name: Is Signal Sciences WAF  enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: e18ed541-babe-4ecf-85f9-d021aa99a0a9
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2997.5,
          "y": 3925
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      note:
        simple: ${inputs.RuleName}
      siteName:
        simple: ${inputs.SiteName}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Adding IPs to the Signal Sciences WAF integration.
      id: 43a85eb5-0e87-4616-8dd2-9644a1c94ed0
      iscommand: true
      name: Is Signal Sciences WAF   - Blacklist IPs
      script: '|||sigsci-blacklist-add-ip'
      type: regular
      version: -1
    taskid: 43a85eb5-0e87-4616-8dd2-9644a1c94ed0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3110,
          "y": 4100
        }
      }
  "74":
    continueonerrortype: ""
    id: "74"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "76"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f0ec8621-f223-46dc-8a04-856aa31e77fd
      iscommand: false
      name: Sophos Firewall
      type: title
      version: -1
    taskid: f0ec8621-f223-46dc-8a04-856aa31e77fd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3897.5,
          "y": 3790
        }
      }
  "75":
    continueonerrortype: ""
    id: "75"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      rule_name:
        simple: ${inputs.RuleName}
      target_ip:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Adds a rule that blocks packets destined for a specific IP address
        or range of IP addresses.
      id: 5a301c99-a5dc-4e0d-8741-01434711d074
      iscommand: true
      name: ARIA Packet Intelligence - Blacklist IPs
      script: '|||aria-block-dest-subnet'
      type: regular
      version: -1
    taskid: 5a301c99-a5dc-4e0d-8741-01434711d074
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 3560,
          "y": 4100
        }
      }
  "76":
    continueonerrortype: ""
    id: "76"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "94"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: sophos_firewall
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 5ad1fa64-7966-44dd-8fb2-656e205dc05d
      iscommand: false
      name: Is Sophos Firewall enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 5ad1fa64-7966-44dd-8fb2-656e205dc05d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3897.5,
          "y": 3925
        }
      }
  "78":
    continueonerrortype: ""
    id: "78"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "75"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: ARIA Packet Intelligence
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: fab5e2cc-1d68-4bd7-867b-032814323d1a
      iscommand: false
      name: Is ARIA Packet Intelligence enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: fab5e2cc-1d68-4bd7-867b-032814323d1a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 3447.5,
          "y": 3925
        }
      }
  "79":
    continueonerrortype: ""
    id: "79"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "78"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e1e1f40-7e8e-422e-8910-c06271450ad8
      iscommand: false
      name: 'ARIA Packet Intelligence '
      type: title
      version: -1
    taskid: 6e1e1f40-7e8e-422e-8910-c06271450ad8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 3447.5,
          "y": 3790
        }
      }
  "80":
    continueonerror: true
    continueonerrortype: ""
    id: "80"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "105"
    note: false
    quietmode: 0
    scriptarguments:
      ip:
        complex:
          root: inputs.IP
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
      ipRanges:
        complex:
          root: inputs.InternalRange
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Returns 'yes' if the IP is in one of the ranges provided. Otherwise
        returns 'no'
      id: 6cf23df7-5f64-445d-845d-3883866f7d46
      iscommand: false
      name: Check if there are internal IP addresses
      script: IsIPInRanges
      type: regular
      version: -1
    taskid: 6cf23df7-5f64-445d-845d-3883866f7d46
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 490
        }
      }
  "85":
    continueonerrortype: ""
    id: "85"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.Input
      stringify:
        simple: "false"
      value:
        complex:
          root: inputs.IP
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Add the IPs from the input.
      id: 744d29e9-f193-478d-8b22-115311053966
      iscommand: false
      name: Append Context List with Input IPs
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 744d29e9-f193-478d-8b22-115311053966
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1060,
          "y": 1580
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.Final
      value:
        simple: ${BlockList.Input}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      id: 83e1b556-8a3a-4ff5-8742-1287ff9f8240
      iscommand: false
      name: Re-set the block list [Inputs]
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 83e1b556-8a3a-4ff5-8742-1287ff9f8240
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 640,
          "y": 2610
        }
      }
  "89":
    continueonerrortype: ""
    id: "89"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
      Override:
        simple: "False"
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: This playbook will append a network group object with new elements
        (IPs or network objects).
      id: 3b230eb6-3a09-41ec-82db-81daa78dee97
      iscommand: false
      name: Cisco FirePower- Append network group object
      playbookName: Cisco FirePower- Append network group object
      type: playbook
      version: -1
    taskid: 3b230eb6-3a09-41ec-82db-81daa78dee97
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 4110
        }
      }
  "90":
    continueonerrortype: ""
    id: "90"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "91"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.Final
      value:
        complex:
          accessor: "2"
          root: Please answer the following.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      id: e8095de9-3bd5-4f8c-8ccb-02d76b87d1a1
      iscommand: false
      name: Re-set the block list [Inputs]
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: e8095de9-3bd5-4f8c-8ccb-02d76b87d1a1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 3120
        }
      }
  "91":
    continueonerrortype: ""
    id: "91"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "92"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.Final
      value:
        complex:
          accessor: "0"
          root: Please answer the following.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      id: 397b5fa6-e8b1-43a0-89d1-b6f63514e8d1
      iscommand: false
      name: Re-set the block list [Malicious]
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: 397b5fa6-e8b1-43a0-89d1-b6f63514e8d1
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 3295
        }
      }
  "92":
    continueonerrortype: ""
    id: "92"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.Final
      value:
        complex:
          accessor: "1"
          root: Please answer the following.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      id: c0352087-e558-45f5-8400-6fec3e641441
      iscommand: false
      name: Re-set the block list [Suspicious]
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: c0352087-e558-45f5-8400-6fec3e641441
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 3470
        }
      }
  "93":
    continueonerrortype: ""
    id: "93"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: ${inputs.RuleName}
      ip:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Adds an IP address or CIDR to the block list.
      id: d0f50f49-291b-40da-8bdf-55c5cdd01df3
      iscommand: true
      name: ThreatX - add IP to a block list
      script: '|||threatx-blacklist-ip'
      type: regular
      version: -1
    taskid: d0f50f49-291b-40da-8bdf-55c5cdd01df3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2660,
          "y": 4110
        }
      }
  "94":
    continueonerrortype: ""
    id: "94"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      IP:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook adds the IP address to a pre-configured firewall rule. (The target firewall rule can be changed as requested.)
        Pre-Requisite:
        1) Create an IP host group.
        2) Create a firewall rule which refers to the IP host group created in the previous step.
      id: f0ffc0b9-feef-4892-859c-a00b778cd8fe
      iscommand: false
      name: Sophos Firewall - Block IP
      playbookName: Sophos Firewall - Block IP
      type: playbook
      version: -1
    taskid: f0ffc0b9-feef-4892-859c-a00b778cd8fe
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 4010,
          "y": 4100
        }
      }
  "95":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${BlockList.PIIP}
          operator: isExists
      label: "yes"
    continueonerrortype: ""
    id: "95"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "98"
      "yes":
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if there are any internal IPs in the block requested IPs.
      id: fec9b088-6d31-4eda-8b5f-3296bd257767
      iscommand: false
      name: Are There Any Internal IPs?
      type: condition
      version: -1
    taskid: fec9b088-6d31-4eda-8b5f-3296bd257767
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1310,
          "y": 2595
        }
      }
  "96":
    continueonerrortype: ""
    id: "96"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 44121d41-e492-4b08-8789-34ee4160adfa
      iscommand: false
      name: No IP to block
      type: title
      version: -1
    taskid: 44121d41-e492-4b08-8789-34ee4160adfa
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -3870,
          "y": 3780
        }
      }
  "98":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Do you approve the blocking request for "Malicious IPs"?
        options: []
        optionsarg:
        - complex:
            accessor: Malicious
            root: BlockList
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Do you approve the blocking request for "Suspiocus IPs"?
        options: []
        optionsarg:
        - complex:
            accessor: Suspicious
            root: BlockList
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "2"
        label: ""
        labelarg:
          simple: Do you approve the blocking request for "Other IPs from Input"?
        options: []
        optionsarg:
        - complex:
            filters:
            - - left:
                  iscontext: true
                  value:
                    simple: BlockList.Input
                operator: notIn
                right:
                  iscontext: true
                  value:
                    simple: BlockList.Suspicious
            - - left:
                  iscontext: true
                  value:
                    simple: BlockList.Input
                operator: notIn
                right:
                  iscontext: true
                  value:
                    simple: BlockList.Malicious
            root: BlockList.Input
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: Your SOC team
      title: Please answer the following
      totalanswers: 0
    id: "98"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: |-
          <p>Dear XSOAR user,</p>
          <p>This notification informs you that the following list of IPs will be blocked on your XSOAR's integrated network devices.</p>
          <p><br />(<strong>Note</strong>: the IPs will be added to your company block list or be blocked in individual rules based on the XSOAR integrated devices).</p>
          <p>&nbsp;</p>
          <p>For more information, click the link below.</p>
      cc:
        simple: Administrator
      format: html
      methods:
      - email
      subject:
        simple: Block IP Playbook - Analyst's Verification
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to:
        simple: Analyst,Administrator
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Ask the user what IPs should be blocked.

        Remember that the direction you have decided is - ${inputs.RuleDirection}
      id: 342e2d51-0427-4bc1-85dd-e53b274549f7
      iscommand: false
      name: Analyst Verification Prompt (without IP Internal List)
      type: collection
      version: -1
    taskid: 342e2d51-0427-4bc1-85dd-e53b274549f7
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 1087.5,
          "y": 2865
        }
      }
  "99":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.InputEnrichment
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    continueonerrortype: ""
    id: "99"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "100"
      "yes":
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if the user requests an IPs enrichment for determining if
        those are malicious or suspicious.
      id: 68b6a610-d4dc-4293-8bf6-015902b9e3dc
      iscommand: false
      name: Should Inputs be enriched?
      type: condition
      version: -1
    taskid: 68b6a610-d4dc-4293-8bf6-015902b9e3dc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 840
        }
      }
  "100":
    continueonerrortype: ""
    id: "100"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.PIIP
      value:
        complex:
          accessor: Address
          filters:
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: IP.InRange
              operator: isEqualString
              right:
                value:
                  simple: "Yes"
          - - ignorecase: true
              left:
                iscontext: true
                value:
                  simple: IP.Address
              operator: inList
              right:
                iscontext: true
                value:
                  simple: inputs.IP
          root: IP
          transformers:
          - operator: uniq
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      id: b28e5315-84f0-4d42-8595-8d01a5214345
      iscommand: false
      name: Append Internal IPs to a possible block list
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: b28e5315-84f0-4d42-8595-8d01a5214345
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 650,
          "y": 1250
        }
      }
  "102":
    continueonerrortype: ""
    id: "102"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "90"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: BlockList.Final
      value:
        complex:
          accessor: "3"
          root: Please answer the following.Answers
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered. If no value is
        entered, the script does nothing.
      id: d8d772aa-064f-4701-8c08-710f49819fb7
      iscommand: false
      name: Re-set the block list [Internal Address]
      script: SetAndHandleEmpty
      type: regular
      version: -1
    taskid: d8d772aa-064f-4701-8c08-710f49819fb7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1532.5,
          "y": 2945
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        complex:
          root: inputs.Tag
      indicatorsValues:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - args:
              separator:
                value:
                  simple: ','
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      id: e0a5eadb-97eb-4117-8771-4ec381dd65dc
      iscommand: true
      name: Update Indicator Tag for EDL
      script: Builtin|||appendIndicatorField
      type: regular
      version: -1
    taskid: e0a5eadb-97eb-4117-8771-4ec381dd65dc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 4460,
          "y": 4100
        }
      }
  "104":
    continueonerrortype: ""
    id: "104"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4f0503b7-bba7-45d9-8e73-3809af7e5d48
      iscommand: false
      name: EDL/EIS
      type: title
      version: -1
    taskid: 4f0503b7-bba7-45d9-8e73-3809af7e5d48
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 4347.5,
          "y": 3790
        }
      }
  "105":
    continueonerrortype: ""
    id: "105"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "99"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      type:
        simple: IP
      value:
        complex:
          root: inputs.IP
          transformers:
          - args:
              delimiter:
                value:
                  simple: ','
            operator: split
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Create System indicators
      id: a966d240-87e4-4d68-8650-7ef30f74a490
      iscommand: true
      name: Create IP indicators in the system
      script: Builtin|||createNewIndicator
      type: regular
      version: -1
    taskid: a966d240-87e4-4d68-8650-7ef30f74a490
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1030,
          "y": 665
        }
      }
  "106":
    continueonerrortype: ""
    id: "106"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "108"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c4cee8d1-81c7-4c4e-8465-0b913bce5337
      iscommand: false
      name: Prisma SASE
      type: title
      version: -1
    taskid: c4cee8d1-81c7-4c4e-8465-0b913bce5337
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -3422.5,
          "y": 3790
        }
      }
  "107":
    continueonerrortype: ""
    id: "107"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      AutoCommit:
        complex:
          root: inputs.AutoCommit
      Folder:
        complex:
          root: inputs.Folder
          transformers:
          - operator: uniq
      IP:
        complex:
          accessor: Final
          root: BlockList
          transformers:
          - operator: uniq
      StaticAddressGroupName:
        complex:
          root: inputs.StaticAddressGroup
          transformers:
          - operator: uniq
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: |-
        This playbook assists in blocking communication with the provided IPs in the Prisma SASE policy.
        If a group name is provided, the IPs will be added to the mentioned static address group (there should be a rule associated with the group name to block communication with that group).
        And if the group name is not provided, a new group will be created with a dedicated rule to block communication with those IPs.
      id: 281f9d65-c396-4441-86f2-340da163d601
      iscommand: false
      name: Prisma SASE - Block IP
      playbookId: Prisma SASE - Block IP
      type: playbook
      version: -1
    taskid: 281f9d65-c396-4441-86f2-340da163d601
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -3422.5,
          "y": 4120
        }
      }
  "108":
    continueonerrortype: ""
    id: "108"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "107"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: Palo Alto Networks - Prisma SASE
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 4d7717be-2f2d-4962-8b96-18edd3a0977c
      iscommand: false
      name: Is Prisma SASE enabled?
      script: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 4d7717be-2f2d-4962-8b96-18edd3a0977c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -3422.5,
          "y": 3945
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "12_2_#default#": 0.11,
      "22_2_#default#": 0.1,
      "23_2_#default#": 0.1,
      "24_2_#default#": 0.1,
      "25_2_#default#": 0.1,
      "27_2_#default#": 0.1,
      "32_2_#default#": 0.21,
      "36_8_#default#": 0.19,
      "41_42_yes": 0.59,
      "41_8_#default#": 0.17,
      "44_95_yes": 0.42,
      "47_48_YES": 0.64,
      "47_8_#default#": 0.24,
      "56_2_#default#": 0.28,
      "58_2_#default#": 0.38,
      "61_2_#default#": 0.1,
      "65_2_#default#": 0.11,
      "68_2_#default#": 0.1,
      "68_69_yes": 0.65,
      "68_93_yes": 0.52,
      "72_2_#default#": 0.16,
      "76_2_#default#": 0.12,
      "78_2_#default#": 0.14,
      "7_2_#default#": 0.1,
      "8_43_yes": 0.5,
      "8_96_#default#": 0.1,
      "99_100_#default#": 0.83,
      "99_53_yes": 0.62
    },
    "paper": {
      "dimensions": {
        "height": 4270,
        "width": 8710,
        "x": -3870,
        "y": 120
      }
    }
  }
